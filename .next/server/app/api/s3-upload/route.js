(()=>{var a={};a.id=86,a.ids=[86],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5486:a=>{"use strict";a.exports=require("bcrypt")},8622:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{A:()=>g});var e=c(64939),f=a([e]);e=(f.then?(await f)():f)[0];let g=global.pgPool??new e.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}});d()}catch(a){d(a)}})},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:a=>{"use strict";a.exports=require("querystring")},12412:a=>{"use strict";a.exports=require("assert")},14701:(a,b,c)=>{"use strict";c.d(b,{A:()=>i});var d=c(77598);let e={randomUUID:d.randomUUID},f=new Uint8Array(256),g=f.length,h=[];for(let a=0;a<256;++a)h.push((a+256).toString(16).slice(1));let i=function(a,b,c){if(e.randomUUID&&!b&&!a)return e.randomUUID();var i=a,j=c;let k=(i=i||{}).random??i.rng?.()??(g>f.length-16&&((0,d.randomFillSync)(f),g=0),f.slice(g,g+=16));if(k.length<16)throw Error("Random bytes length must be >= 16");if(k[6]=15&k[6]|64,k[8]=63&k[8]|128,b){if((j=j||0)<0||j+16>b.length)throw RangeError(`UUID byte range ${j}:${j+15} is out of buffer bounds`);for(let a=0;a<16;++a)b[j+a]=k[a];return b}return function(a,b=0){return(h[a[b+0]]+h[a[b+1]]+h[a[b+2]]+h[a[b+3]]+"-"+h[a[b+4]]+h[a[b+5]]+"-"+h[a[b+6]]+h[a[b+7]]+"-"+h[a[b+8]]+h[a[b+9]]+"-"+h[a[b+10]]+h[a[b+11]]+h[a[b+12]]+h[a[b+13]]+h[a[b+14]]+h[a[b+15]]).toLowerCase()}(k)}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:a=>{"use strict";a.exports=require("os")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},35413:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{POST:()=>l});var e=c(10641),f=c(52963),g=c(95645),h=c(91043),i=c(54063),j=c(14701),k=a([g]);g=(k.then?(await k)():k)[0];let m=new h.S3Client({region:process.env.AWS_S3_REGION,credentials:{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY}});async function l(a){let b=await (0,f.getServerSession)(g.N);if(!b?.user?.id)return e.NextResponse.json({error:"Unauthorized"},{status:401});try{let{fileName:c,fileType:d,entityType:f}=await a.json();if(!c||!d||!f)return e.NextResponse.json({error:"Missing required fields"},{status:400});let g=`${b.user.id}/${f}/${(0,j.A)()}-${c}`,k=new h.PutObjectCommand({Bucket:process.env.AWS_S3_BUCKET_NAME,Key:g,ContentType:d}),l=await (0,i.A)(m,k,{expiresIn:3600});return e.NextResponse.json({uploadUrl:l,s3Key:g})}catch(a){return console.error("Error creating presigned URL:",a),e.NextResponse.json({error:"Failed to create upload URL"},{status:500})}}d()}catch(a){d(a)}})},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},49056:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{handler:()=>x,patchFetch:()=>w,routeModule:()=>y,serverHooks:()=>B,workAsyncStorage:()=>z,workUnitAsyncStorage:()=>A});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(35413),v=a([u]);u=(v.then?(await v)():v)[0];let y=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/s3-upload/route",pathname:"/api/s3-upload",filename:"route",bundlePath:"app/api/s3-upload/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/ramanakumar/TaskGlyph/src/app/api/s3-upload/route.ts",nextConfigOutput:"",userland:u}),{workAsyncStorage:z,workUnitAsyncStorage:A,serverHooks:B}=y;function w(){return(0,g.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:A})}async function x(a,b,c){var d;let e="/api/s3-upload/route";"/index"===e&&(e="/");let g=await y.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!x){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||y.isDev||x||(G=D,G="/index"===G?"/":G);let H=!0===y.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>y.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>y.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await y.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await y.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await y.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}d()}catch(a){d(a)}})},52963:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d={};Object.defineProperty(b,"default",{enumerable:!0,get:function(){return f.default}});var e=c(96434);Object.keys(e).forEach(function(a){!("default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a))&&(a in b&&b[a]===e[a]||Object.defineProperty(b,a,{enumerable:!0,get:function(){return e[a]}}))});var f=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=g(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&({}).hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(d,f,h):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}(c(1093));function g(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(g=function(a){return a?c:b})(a)}Object.keys(f).forEach(function(a){!("default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a))&&(a in b&&b[a]===f[a]||Object.defineProperty(b,a,{enumerable:!0,get:function(){return f[a]}}))})},54063:(a,b,c)=>{"use strict";c.d(b,{A:()=>aD});let d=a=>encodeURIComponent(a).replace(/[!'()*]/g,e),e=a=>`%${a.charCodeAt(0).toString(16).toUpperCase()}`,f=async a=>{let b=a?.Bucket||"";if("string"==typeof a.Bucket&&(a.Bucket=b.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),k(b)){if(!0===a.ForcePathStyle)throw Error("Path-style addressing cannot be used with ARN buckets")}else j(b)&&(-1===b.indexOf(".")||String(a.Endpoint).startsWith("http:"))&&b.toLowerCase()===b&&!(b.length<3)||(a.ForcePathStyle=!0);return a.DisableMultiRegionAccessPoints&&(a.disableMultiRegionAccessPoints=!0,a.DisableMRAP=!0),a},g=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,h=/(\d+\.){3}\d+/,i=/\.\./,j=a=>g.test(a)&&!h.test(a)&&!i.test(a),k=a=>{let[b,c,d,,,e]=a.split(":"),f="arn"===b&&a.split(":").length>=6,g=!!(f&&c&&d&&e);if(f&&!g)throw Error(`Invalid ARN: ${a} was an invalid ARN.`);return g},l=(a,b,c)=>{let d=async()=>{let d=c[a]??c[b];return"function"==typeof d?d():d};return"credentialScope"===a||"CredentialScope"===b?async()=>{let a="function"==typeof c.credentials?await c.credentials():c.credentials;return a?.credentialScope??a?.CredentialScope}:"accountId"===a||"AccountId"===b?async()=>{let a="function"==typeof c.credentials?await c.credentials():c.credentials;return a?.accountId??a?.AccountId}:"endpoint"===a||"endpoint"===b?async()=>{if(!1===c.isCustomEndpoint)return;let a=await d();if(a&&"object"==typeof a){if("url"in a)return a.url.href;if("hostname"in a){let{protocol:b,hostname:c,port:d,path:e}=a;return`${b}//${c}${d?":"+d:""}${e}`}}return a}:d};class m extends Error{name="ProviderError";tryNextLink;constructor(a,b=!0){let c,d=!0;"boolean"==typeof b?(c=void 0,d=b):null!=b&&"object"==typeof b&&(c=b.logger,d=b.tryNextLink??!0),super(a),this.tryNextLink=d,Object.setPrototypeOf(this,m.prototype),c?.debug?.(`@smithy/property-provider ${d?"->":"(!)"} ${a}`)}static from(a,b=!0){return Object.assign(new this(a.message,b),a)}}class n extends m{name="CredentialsProviderError";constructor(a,b=!0){super(a,b),Object.setPrototypeOf(this,n.prototype)}}function o(a){try{let b=new Set(Array.from(a.match(/([A-Z_]){3,}/g)??[]));return b.delete("CONFIG"),b.delete("CONFIG_PREFIX_SEPARATOR"),b.delete("ENV"),[...b].join(", ")}catch(b){return a}}var p,q,r,s=c(33873);!function(a){a.PROFILE="profile",a.SSO_SESSION="sso-session",a.SERVICES="services"}(p||(p={}));let t=a=>Object.entries(a).filter(([a])=>{let b=a.indexOf(".");return -1!==b&&Object.values(p).includes(a.substring(0,b))}).reduce((a,[b,c])=>{let d=b.indexOf(".");return a[b.substring(0,d)===p.PROFILE?b.substring(d+1):b]=c,a},{...a.default&&{default:a.default}});var u=c(21820);let v={},w=()=>{let{HOME:a,USERPROFILE:b,HOMEPATH:c,HOMEDRIVE:d=`C:${s.sep}`}=process.env;if(a)return a;if(b)return b;if(c)return`${d}${c}`;let e=process&&process.geteuid?`${process.geteuid()}`:"DEFAULT";return v[e]||(v[e]=(0,u.homedir)()),v[e]},x=/^([\w-]+)\s(["'])?([\w-@\+\.%:/]+)\2$/,y=["__proto__","profile __proto__"],z=a=>{let b,c,d={};for(let e of a.split(/\r?\n/)){let a=e.split(/(^|\s)[;#]/)[0].trim();if("["===a[0]&&"]"===a[a.length-1]){b=void 0,c=void 0;let d=a.substring(1,a.length-1),e=x.exec(d);if(e){let[,a,,c]=e;Object.values(p).includes(a)&&(b=[a,c].join("."))}else b=d;if(y.includes(d))throw Error(`Found invalid profile name "${d}"`)}else if(b){let f=a.indexOf("=");if(![0,-1].includes(f)){let[g,h]=[a.substring(0,f).trim(),a.substring(f+1).trim()];if(""===h)c=g;else{c&&e.trimStart()===e&&(c=void 0),d[b]=d[b]||{};let a=c?[c,g].join("."):g;d[b][a]=h}}}}return d},{readFile:A}=c(29021).promises,B={},C={},D=(a,b)=>void 0!==C[a]?C[a]:((!B[a]||b?.ignoreCache)&&(B[a]=A(a,"utf8")),B[a]),E=()=>({}),F=async(a={})=>{let{filepath:b=process.env.AWS_SHARED_CREDENTIALS_FILE||(0,s.join)(w(),".aws","credentials"),configFilepath:c=process.env.AWS_CONFIG_FILE||(0,s.join)(w(),".aws","config")}=a,d=w(),e=b;b.startsWith("~/")&&(e=(0,s.join)(d,b.slice(2)));let f=c;c.startsWith("~/")&&(f=(0,s.join)(d,c.slice(2)));let g=await Promise.all([D(f,{ignoreCache:a.ignoreCache}).then(z).then(t).catch(E),D(e,{ignoreCache:a.ignoreCache}).then(z).catch(E)]);return{configFile:g[0],credentialsFile:g[1]}},G="AWS_ENDPOINT_URL",H="endpoint_url",I=async a=>(({environmentVariableSelector:a,configFileSelector:b,default:c},d={})=>{let{signingName:e,logger:f}=d;return((a,b,c)=>{let d,e,f,g=async()=>{e||(e=a());try{d=await e,f=!0}finally{e=void 0}return d};return async a=>((!f||a?.forceRefresh)&&(d=await g()),d)})(((...a)=>async()=>{let b;if(0===a.length)throw new m("No providers in chain");for(let c of a)try{return await c()}catch(a){if(b=a,a?.tryNextLink)continue;throw a}throw b})(((a,b)=>async()=>{try{let c=a(process.env,b);if(void 0===c)throw Error();return c}catch(c){throw new n(c.message||`Not found in ENV: ${o(a.toString())}`,{logger:b?.logger})}})(a,{signingName:e,logger:f}),((a,{preferredFile:b="config",...c}={})=>async()=>{let d=c.profile||process.env.AWS_PROFILE||"default",{configFile:e,credentialsFile:f}=await F(c),g=f[d]||{},h=e[d]||{},i="config"===b?{...g,...h}:{...h,...g};try{let c="config"===b?e:f,d=a(i,c);if(void 0===d)throw Error();return d}catch(b){throw new n(b.message||`Not found in config files w/ profile [${d}]: ${o(a.toString())}`,{logger:c.logger})}})(b,d),(a=>"function"==typeof a?async()=>await a():()=>Promise.resolve(a))(c)))})((a=>({environmentVariableSelector:b=>{let c=b[[G,...a.split(" ").map(a=>a.toUpperCase())].join("_")];if(c)return c;let d=b[G];if(d)return d},configFileSelector:(b,c)=>{if(c&&b.services){let d=c[["services",b.services].join(".")];if(d){let b=d[[a.split(" ").map(a=>a.toLowerCase()).join("_"),H].join(".")];if(b)return b}}let d=b[H];if(d)return d},default:void 0}))(a??""))(),J=a=>{let b;if("string"==typeof a)return J(new URL(a));let{hostname:c,pathname:d,port:e,protocol:f,search:g}=a;return g&&(b=function(a){let b={};if(a=a.replace(/^\?/,""))for(let c of a.split("&")){let[a,d=null]=c.split("=");a=decodeURIComponent(a),d&&(d=decodeURIComponent(d)),a in b?Array.isArray(b[a])?b[a].push(d):b[a]=[b[a],d]:b[a]=d}return b}(g)),{hostname:c,port:e?parseInt(e):void 0,protocol:f,path:d,query:b}},K=async(a,b,c,d)=>{if(!c.isCustomEndpoint){let a;(a=c.serviceConfiguredEndpoint?await c.serviceConfiguredEndpoint():await I(c.serviceId))&&(c.endpoint=()=>Promise.resolve((a=>"object"==typeof a?"url"in a?J(a.url):a:J(a))(a)),c.isCustomEndpoint=!0)}let e=await L(a,b,c);if("function"!=typeof c.endpointProvider)throw Error("config.endpointProvider is not set.");return c.endpointProvider(e,d)},L=async(a,b,c)=>{let d={},e=b?.getEndpointParameterInstructions?.()||{};for(let[b,f]of Object.entries(e))switch(f.type){case"staticContextParams":d[b]=f.value;break;case"contextParams":d[b]=a[f.name];break;case"clientContextParams":case"builtInParams":d[b]=await l(f.name,b,c)();break;case"operationContextParams":d[b]=f.get(a);break;default:throw Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(f))}return 0===Object.keys(e).length&&Object.assign(d,c),"s3"===String(c.serviceId).toLowerCase()&&await f(d),d};class M{method;protocol;hostname;port;path;query;headers;username;password;fragment;body;constructor(a){this.method=a.method||"GET",this.hostname=a.hostname||"localhost",this.port=a.port,this.query=a.query||{},this.headers=a.headers||{},this.body=a.body,this.protocol=a.protocol?":"!==a.protocol.slice(-1)?`${a.protocol}:`:a.protocol:"https:",this.path=a.path?"/"!==a.path.charAt(0)?`/${a.path}`:a.path:"/",this.username=a.username,this.password=a.password,this.fragment=a.fragment}static clone(a){var b;let c=new M({...a,headers:{...a.headers}});return c.query&&(c.query=Object.keys(b=c.query).reduce((a,c)=>{let d=b[c];return{...a,[c]:Array.isArray(d)?[...d]:d}},{})),c}static isInstance(a){return!!a&&"method"in a&&"protocol"in a&&"hostname"in a&&"path"in a&&"object"==typeof a.query&&"object"==typeof a.headers}clone(){return M.clone(this)}}let N={},O={};for(let a=0;a<256;a++){let b=a.toString(16).toLowerCase();1===b.length&&(b=`0${b}`),N[a]=b,O[b]=a}function P(a){let b="";for(let c=0;c<a.byteLength;c++)b+=N[a[c]];return b}var Q=c(79428);let R=a=>{let b=((a,b)=>{if("string"!=typeof a)throw TypeError(`The "input" argument must be of type string. Received type ${typeof a} (${a})`);return b?Q.Buffer.from(a,b):Q.Buffer.from(a)})(a,"utf8");return new Uint8Array(b.buffer,b.byteOffset,b.byteLength/Uint8Array.BYTES_PER_ELEMENT)},S=a=>"string"==typeof a?R(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a),T="X-Amz-Date",U="X-Amz-Signature",V="X-Amz-Security-Token",W="authorization",X=T.toLowerCase(),Y=[W,X,"date"],Z=U.toLowerCase(),$="x-amz-content-sha256",_=V.toLowerCase(),aa={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},ab=/^proxy-/,ac=/^sec-/,ad="AWS4-HMAC-SHA256",ae="aws4_request",af={},ag=[],ah=(a,b,c)=>`${a}/${b}/${c}/${ae}`,ai=async(a,b,c,d,e)=>{let f=await aj(a,b.secretAccessKey,b.accessKeyId),g=`${c}:${d}:${e}:${P(f)}:${b.sessionToken}`;if(g in af)return af[g];for(ag.push(g);ag.length>50;)delete af[ag.shift()];let h=`AWS4${b.secretAccessKey}`;for(let b of[c,d,e,ae])h=await aj(a,h,b);return af[g]=h},aj=(a,b,c)=>{let d=new a(b);return d.update(S(c)),d.digest()},ak=({headers:a},b,c)=>{let d={};for(let e of Object.keys(a).sort()){if(void 0==a[e])continue;let f=e.toLowerCase();(!(f in aa||b?.has(f)||ab.test(f)||ac.test(f))||c&&(!c||c.has(f)))&&(d[f]=a[e].trim().replace(/\s+/g," "))}return d},al=async({headers:a,body:b},c)=>{for(let b of Object.keys(a))if(b.toLowerCase()===$)return a[b];if(void 0==b)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if("string"==typeof b||ArrayBuffer.isView(b)||(a=>"function"==typeof ArrayBuffer&&a instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(a))(b)){let a=new c;return a.update(S(b)),P(await a.digest())}return"UNSIGNED-PAYLOAD"};class am{format(a){let b=[];for(let c of Object.keys(a)){let d=R(c);b.push(Uint8Array.from([d.byteLength]),d,this.formatHeaderValue(a[c]))}let c=new Uint8Array(b.reduce((a,b)=>a+b.byteLength,0)),d=0;for(let a of b)c.set(a,d),d+=a.byteLength;return c}formatHeaderValue(a){switch(a.type){case"boolean":return Uint8Array.from([+!a.value]);case"byte":return Uint8Array.from([2,a.value]);case"short":let b=new DataView(new ArrayBuffer(3));return b.setUint8(0,3),b.setInt16(1,a.value,!1),new Uint8Array(b.buffer);case"integer":let c=new DataView(new ArrayBuffer(5));return c.setUint8(0,4),c.setInt32(1,a.value,!1),new Uint8Array(c.buffer);case"long":let d=new Uint8Array(9);return d[0]=5,d.set(a.value.bytes,1),d;case"binary":let e=new DataView(new ArrayBuffer(3+a.value.byteLength));e.setUint8(0,6),e.setUint16(1,a.value.byteLength,!1);let f=new Uint8Array(e.buffer);return f.set(a.value,3),f;case"string":let g=R(a.value),h=new DataView(new ArrayBuffer(3+g.byteLength));h.setUint8(0,7),h.setUint16(1,g.byteLength,!1);let i=new Uint8Array(h.buffer);return i.set(g,3),i;case"timestamp":let j=new Uint8Array(9);return j[0]=8,j.set(ao.fromNumber(a.value.valueOf()).bytes,1),j;case"uuid":if(!an.test(a.value))throw Error(`Invalid UUID received: ${a.value}`);let k=new Uint8Array(17);return k[0]=9,k.set(function(a){if(a.length%2!=0)throw Error("Hex encoded strings must have an even number length");let b=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2){let d=a.slice(c,c+2).toLowerCase();if(d in O)b[c/2]=O[d];else throw Error(`Cannot decode unrecognized sequence ${d} as hexadecimal`)}return b}(a.value.replace(/\-/g,"")),1),k}}}!function(a){a[a.boolTrue=0]="boolTrue",a[a.boolFalse=1]="boolFalse",a[a.byte=2]="byte",a[a.short=3]="short",a[a.integer=4]="integer",a[a.long=5]="long",a[a.byteArray=6]="byteArray",a[a.string=7]="string",a[a.timestamp=8]="timestamp",a[a.uuid=9]="uuid"}(q||(q={}));let an=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class ao{bytes;constructor(a){if(this.bytes=a,8!==a.byteLength)throw Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(a){if(a>0x8000000000000000||a<-0x8000000000000000)throw Error(`${a} is too large (or, if negative, too small) to represent as an Int64`);let b=new Uint8Array(8);for(let c=7,d=Math.abs(Math.round(a));c>-1&&d>0;c--,d/=256)b[c]=d;return a<0&&ap(b),new ao(b)}valueOf(){let a=this.bytes.slice(0),b=128&a[0];return b&&ap(a),parseInt(P(a),16)*(b?-1:1)}toString(){return String(this.valueOf())}}function ap(a){for(let b=0;b<8;b++)a[b]^=255;for(let b=7;b>-1&&(a[b]++,0===a[b]);b--);}let aq=a=>{for(let b of Object.keys((a=M.clone(a)).headers))Y.indexOf(b.toLowerCase())>-1&&delete a.headers[b];return a},ar=a=>{if("function"==typeof a)return a;let b=Promise.resolve(a);return()=>b};class as{service;regionProvider;credentialProvider;sha256;uriEscapePath;applyChecksum;constructor({applyChecksum:a,credentials:b,region:c,service:d,sha256:e,uriEscapePath:f=!0}){this.service=d,this.sha256=e,this.uriEscapePath=f,this.applyChecksum="boolean"!=typeof a||a,this.regionProvider=ar(c),this.credentialProvider=ar(b)}createCanonicalRequest(a,b,c){let e=Object.keys(b).sort();return`${a.method}
${this.getCanonicalPath(a)}
${(({query:a={}})=>{let b=[],c={};for(let e of Object.keys(a)){if(e.toLowerCase()===Z)continue;let f=d(e);b.push(f);let g=a[e];"string"==typeof g?c[f]=`${f}=${d(g)}`:Array.isArray(g)&&(c[f]=g.slice(0).reduce((a,b)=>a.concat([`${f}=${d(b)}`]),[]).sort().join("&"))}return b.sort().map(a=>c[a]).filter(a=>a).join("&")})(a)}
${e.map(a=>`${a}:${b[a]}`).join("\n")}

${e.join(";")}
${c}`}async createStringToSign(a,b,c,d){let e=new this.sha256;e.update(S(c));let f=await e.digest();return`${d}
${a}
${b}
${P(f)}`}getCanonicalPath({path:a}){if(this.uriEscapePath){let b=[];for(let c of a.split("/"))c?.length!==0&&"."!==c&&(".."===c?b.pop():b.push(c));return d(`${a?.startsWith("/")?"/":""}${b.join("/")}${b.length>0&&a?.endsWith("/")?"/":""}`).replace(/%2F/g,"/")}return a}validateResolvedCredentials(a){if("object"!=typeof a||"string"!=typeof a.accessKeyId||"string"!=typeof a.secretAccessKey)throw Error("Resolved credential object is not valid")}formatDate(a){var b;let c=("number"==typeof(b=a)?new Date(1e3*b):"string"==typeof b?new Date(Number(b)?1e3*Number(b):b):b).toISOString().replace(/\.\d{3}Z$/,"Z").replace(/[\-:]/g,"");return{longDate:c,shortDate:c.slice(0,8)}}getCanonicalHeaderList(a){return Object.keys(a).sort().join(";")}}class at extends as{headerFormatter=new am;constructor({applyChecksum:a,credentials:b,region:c,service:d,sha256:e,uriEscapePath:f=!0}){super({applyChecksum:a,credentials:b,region:c,service:d,sha256:e,uriEscapePath:f})}async presign(a,b={}){let{signingDate:c=new Date,expiresIn:d=3600,unsignableHeaders:e,unhoistableHeaders:f,signableHeaders:g,hoistableHeaders:h,signingRegion:i,signingService:j}=b,k=await this.credentialProvider();this.validateResolvedCredentials(k);let l=i??await this.regionProvider(),{longDate:m,shortDate:n}=this.formatDate(c);if(d>604800)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let o=ah(n,l,j??this.service),p=((a,b={})=>{let{headers:c,query:d={}}=M.clone(a);for(let a of Object.keys(c)){let e=a.toLowerCase();("x-amz-"===e.slice(0,6)&&!b.unhoistableHeaders?.has(e)||b.hoistableHeaders?.has(e))&&(d[a]=c[a],delete c[a])}return{...a,headers:c,query:d}})(aq(a),{unhoistableHeaders:f,hoistableHeaders:h});k.sessionToken&&(p.query[V]=k.sessionToken),p.query["X-Amz-Algorithm"]=ad,p.query["X-Amz-Credential"]=`${k.accessKeyId}/${o}`,p.query[T]=m,p.query["X-Amz-Expires"]=d.toString(10);let q=ak(p,e,g);return p.query["X-Amz-SignedHeaders"]=this.getCanonicalHeaderList(q),p.query[U]=await this.getSignature(m,o,this.getSigningKey(k,l,n,j),this.createCanonicalRequest(p,q,await al(a,this.sha256))),p}async sign(a,b){return"string"==typeof a?this.signString(a,b):a.headers&&a.payload?this.signEvent(a,b):a.message?this.signMessage(a,b):this.signRequest(a,b)}async signEvent({headers:a,payload:b},{signingDate:c=new Date,priorSignature:d,signingRegion:e,signingService:f}){let g=e??await this.regionProvider(),{shortDate:h,longDate:i}=this.formatDate(c),j=ah(h,g,f??this.service),k=await al({headers:{},body:b},this.sha256),l=new this.sha256;l.update(a);let m=["AWS4-HMAC-SHA256-PAYLOAD",i,j,d,P(await l.digest()),k].join("\n");return this.signString(m,{signingDate:c,signingRegion:g,signingService:f})}async signMessage(a,{signingDate:b=new Date,signingRegion:c,signingService:d}){return this.signEvent({headers:this.headerFormatter.format(a.message.headers),payload:a.message.body},{signingDate:b,signingRegion:c,signingService:d,priorSignature:a.priorSignature}).then(b=>({message:a.message,signature:b}))}async signString(a,{signingDate:b=new Date,signingRegion:c,signingService:d}={}){let e=await this.credentialProvider();this.validateResolvedCredentials(e);let f=c??await this.regionProvider(),{shortDate:g}=this.formatDate(b),h=new this.sha256(await this.getSigningKey(e,f,g,d));return h.update(S(a)),P(await h.digest())}async signRequest(a,{signingDate:b=new Date,signableHeaders:c,unsignableHeaders:d,signingRegion:e,signingService:f}={}){let g=await this.credentialProvider();this.validateResolvedCredentials(g);let h=e??await this.regionProvider(),i=aq(a),{longDate:j,shortDate:k}=this.formatDate(b),l=ah(k,h,f??this.service);i.headers[X]=j,g.sessionToken&&(i.headers[_]=g.sessionToken);let m=await al(i,this.sha256);!((a,b)=>{for(let c of(a=a.toLowerCase(),Object.keys(b)))if(a===c.toLowerCase())return!0;return!1})($,i.headers)&&this.applyChecksum&&(i.headers[$]=m);let n=ak(i,d,c),o=await this.getSignature(j,l,this.getSigningKey(g,h,k,f),this.createCanonicalRequest(i,n,m));return i.headers[W]=`${ad} Credential=${g.accessKeyId}/${l}, SignedHeaders=${this.getCanonicalHeaderList(n)}, Signature=${o}`,i}async getSignature(a,b,c,d){let e=await this.createStringToSign(a,b,d,ad),f=new this.sha256(await c);return f.update(S(e)),P(await f.digest())}getSigningKey(a,b,c,d){return ai(this.sha256,a,c,b,d||this.service)}}!function(a){a.ENV="env",a.CONFIG="shared config entry"}(r||(r={}));let au="X-Amz-S3session-Token",av=au.toLowerCase();class aw extends at{async signWithCredentials(a,b,c){let d=ax(b);return a.headers[av]=b.sessionToken,ay(this,d),this.signRequest(a,c??{})}async presignWithCredentials(a,b,c){let d=ax(b);return delete a.headers[av],a.headers[au]=b.sessionToken,a.query=a.query??{},a.query[au]=b.sessionToken,ay(this,d),this.presign(a,c)}}function ax(a){return{accessKeyId:a.accessKeyId,secretAccessKey:a.secretAccessKey,expiration:a.expiration}}function ay(a,b){let c=setTimeout(()=>{throw Error("SignatureV4S3Express credential override was created but not called.")},10),d=a.credentialProvider;a.credentialProvider=()=>(clearTimeout(c),a.credentialProvider=d,Promise.resolve(b))}let az={SignatureV4a:null},aA={CrtSignerV4:null};class aB{sigv4aSigner;sigv4Signer;signerOptions;static sigv4aDependency(){return"function"==typeof aA.CrtSignerV4?"crt":"function"==typeof az.SignatureV4a?"js":"none"}constructor(a){this.sigv4Signer=new aw(a),this.signerOptions=a}async sign(a,b={}){return"*"===b.signingRegion?this.getSigv4aSigner().sign(a,b):this.sigv4Signer.sign(a,b)}async signWithCredentials(a,b,c={}){if("*"===c.signingRegion){let d=this.getSigv4aSigner(),e=aA.CrtSignerV4;if(e&&d instanceof e)return d.signWithCredentials(a,b,c);throw Error('signWithCredentials with signingRegion \'*\' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt')}return this.sigv4Signer.signWithCredentials(a,b,c)}async presign(a,b={}){if("*"===b.signingRegion){let c=this.getSigv4aSigner(),d=aA.CrtSignerV4;if(d&&c instanceof d)return c.presign(a,b);throw Error('presign with signingRegion \'*\' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt')}return this.sigv4Signer.presign(a,b)}async presignWithCredentials(a,b,c={}){if("*"===c.signingRegion)throw Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(a,b,c)}getSigv4aSigner(){if(!this.sigv4aSigner){let a=aA.CrtSignerV4,b=az.SignatureV4a;if("node"===this.signerOptions.runtime){if(!a&&!b)throw Error("Neither CRT nor JS SigV4a implementation is available. Please load either @aws-sdk/signature-v4-crt or @aws-sdk/signature-v4a. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt");if(a&&"function"==typeof a)this.sigv4aSigner=new a({...this.signerOptions,signingAlgorithm:1});else if(b&&"function"==typeof b)this.sigv4aSigner=new b({...this.signerOptions});else throw Error("Available SigV4a implementation is not a valid constructor. Please ensure you've properly imported @aws-sdk/signature-v4-crt or @aws-sdk/signature-v4a.For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt")}else{if(!b||"function"!=typeof b)throw Error("JS SigV4a implementation is not available or not a valid constructor. Please check whether you have installed the @aws-sdk/signature-v4a package explicitly. The CRT implementation is not available for browsers. You must also register the package by calling [require('@aws-sdk/signature-v4a');] or an ESM equivalent such as [import '@aws-sdk/signature-v4a';]. For more information please go to https://github.com/aws/aws-sdk-js-v3#using-javascript-non-crt-implementation-of-sigv4a");this.sigv4aSigner=new b({...this.signerOptions})}}return this.sigv4aSigner}}class aC{signer;constructor(a){let b={service:a.signingName||a.service||"s3",uriEscapePath:a.uriEscapePath||!1,applyChecksum:a.applyChecksum||!1,...a};this.signer=new aB(b)}presign(a,{unsignableHeaders:b=new Set,hoistableHeaders:c=new Set,unhoistableHeaders:d=new Set,...e}={}){return this.prepareRequest(a,{unsignableHeaders:b,unhoistableHeaders:d,hoistableHeaders:c}),this.signer.presign(a,{expiresIn:900,unsignableHeaders:b,unhoistableHeaders:d,...e})}presignWithCredentials(a,b,{unsignableHeaders:c=new Set,hoistableHeaders:d=new Set,unhoistableHeaders:e=new Set,...f}={}){return this.prepareRequest(a,{unsignableHeaders:c,unhoistableHeaders:e,hoistableHeaders:d}),this.signer.presignWithCredentials(a,b,{expiresIn:900,unsignableHeaders:c,unhoistableHeaders:e,...f})}prepareRequest(a,{unsignableHeaders:b=new Set,unhoistableHeaders:c=new Set,hoistableHeaders:d=new Set}={}){b.add("content-type"),Object.keys(a.headers).map(a=>a.toLowerCase()).filter(a=>a.startsWith("x-amz-server-side-encryption")).forEach(a=>{d.has(a)||c.add(a)}),a.headers["X-Amz-Content-Sha256"]="UNSIGNED-PAYLOAD";let e=a.headers.host,f=a.port,g=`${a.hostname}${null!=a.port?":"+f:""}`;e&&(e!==a.hostname||null==a.port)||(a.headers.host=g)}}let aD=async(a,b,c={})=>{let e,f;if("function"==typeof a.config.endpointProvider){let c=await K(b.input,b.constructor,a.config),d=c.properties?.authSchemes?.[0];f=d?.name==="sigv4a"?d?.signingRegionSet?.join(","):d?.signingRegion,e=new aC({...a.config,signingName:d?.signingName,region:async()=>f})}else e=new aC(a.config);let g=a.middlewareStack.clone();g.addRelativeTo((a,b)=>async a=>{let{request:d}=a;if(!M.isInstance(d))throw Error("Request to be presigned is not an valid HTTP request.");delete d.headers["amz-sdk-invocation-id"],delete d.headers["amz-sdk-request"],delete d.headers["x-amz-user-agent"];let g={...c,signingRegion:c.signingRegion??b.signing_region??f,signingService:c.signingService??b.signing_service};return{response:{},output:{$metadata:{httpStatusCode:200},presigned:b.s3ExpressIdentity?await e.presignWithCredentials(d,b.s3ExpressIdentity,g):await e.presign(d,g)}}},{name:"presignInterceptMiddleware",relation:"before",toMiddleware:"awsAuthMiddleware",override:!0});let h=b.resolveMiddleware(g,a.config,{}),{output:i}=await h({input:b.input}),{presigned:j}=i;return function(a){let{port:b,query:c}=a,{protocol:e,path:f,hostname:g}=a;e&&":"!==e.slice(-1)&&(e+=":"),b&&(g+=`:${b}`),f&&"/"!==f.charAt(0)&&(f=`/${f}`);let h=c?function(a){let b=[];for(let c of Object.keys(a).sort()){let e=a[c];if(c=d(c),Array.isArray(e))for(let a=0,f=e.length;a<f;a++)b.push(`${c}=${d(e[a])}`);else{let a=c;(e||"string"==typeof e)&&(a+=`=${d(e)}`),b.push(a)}}return b.join("&")}(c):"";h&&"?"!==h[0]&&(h=`?${h}`);let i="";if(null!=a.username||null!=a.password){let b=a.username??"",c=a.password??"";i=`${b}:${c}@`}let j="";return a.fragment&&(j=`#${a.fragment}`),`${e}//${i}${g}${f}${h}${j}`}(j)}},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64939:a=>{"use strict";a.exports=import("pg")},74075:a=>{"use strict";a.exports=require("zlib")},77598:a=>{"use strict";a.exports=require("node:crypto")},78335:()=>{},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},81630:a=>{"use strict";a.exports=require("http")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},91043:a=>{"use strict";a.exports=require("@aws-sdk/client-s3")},94735:a=>{"use strict";a.exports=require("events")},95645:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{N:()=>k});var e=c(75783),f=c(28120),g=c(8622),h=c(5486),i=c.n(h),j=a([g]);g=(j.then?(await j)():j)[0];let k={providers:[(0,e.A)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||""}),(0,f.A)({name:"Email & Password",credentials:{email:{label:"Email",type:"email",placeholder:"you@example.com"},password:{label:"Password",type:"password"}},async authorize(a){if(!a?.email||!a?.password)return console.error("Credentials missing"),null;try{let{rows:b}=await g.A.query("SELECT id, email, name, password FROM users WHERE email = $1",[a.email.toLowerCase()]);if(0===b.length)return console.log("No user found with that email"),null;let c=b[0];if(!c.password)return console.log("User signed up via Google, password login not possible"),null;if(!await i().compare(a.password,c.password))return console.log("Invalid password"),null;return console.log("✅ Password validation successful for:",c.email),{id:c.id,name:c.name,email:c.email}}catch(a){return console.error("❌ DB error during authorization:",a),null}}})],session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET,pages:{signIn:"/auth/signin"},callbacks:{jwt:async({token:a,user:b})=>(b&&(a.id=b.id),a),session:async({session:a,token:b})=>(a.user&&b.id&&(a.user.id=b.id),a),async signIn({user:a,account:b}){if(b?.provider==="google"&&a.email){let b=a.id;try{let{rows:c}=await g.A.query("SELECT id FROM users WHERE id = $1",[b]);0===c.length&&(await g.A.query(`INSERT INTO users (id, email, name, tier)
               VALUES ($1, $2, $3, $4)`,[b,a.email,a.name||null,"free"]),console.log("✅ New Google user created:",b))}catch(a){return console.error("❌ DB error during Google sign-in:",a),!1}}return!0}}};d()}catch(a){d(a)}})},96434:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0})},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[996,692,94],()=>b(b.s=49056));module.exports=c})();
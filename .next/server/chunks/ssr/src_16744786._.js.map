{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/deleteFromS3.ts"],"sourcesContent":["/**\n * Deletes a file from AWS S3 via your Next.js API route.\n * * @param url - The full S3 URL of the file to delete\n * @returns boolean - True if deleted successfully\n */\nexport async function deleteFromS3(url: string): Promise<boolean> {\n  try {\n    const res = await fetch(\"/api/s3-delete\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ url }),\n    });\n\n    if (!res.ok) {\n      const err = await res.json();\n      console.error(\"Failed to delete from S3:\", err.error);\n      return false;\n    }\n\n    return true;\n  } catch (error) {\n    console.error(\"Error in deleteFromS3:\", error);\n    return false;\n  }\n}\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;AACM,eAAe,aAAa,GAAW;IAC5C,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,kBAAkB;YACxC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAI;QAC7B;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,MAAM,MAAM,IAAI,IAAI;YAC1B,QAAQ,KAAK,CAAC,6BAA6B,IAAI,KAAK;YACpD,OAAO;QACT;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/db/useNotes.ts"],"sourcesContent":["\"use client\";\n\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport db, { Note, OperationType, EntityType, Folder } from \"./clientDb\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { useTier } from \"./useTier\";\nimport { triggerSync } from \"../sync/syncService\";\nimport { deleteFromS3 } from \"@/lib/deleteFromS3\"; // [NEW] Import delete S3\n\n// --- 1. Notes Hook ---\nexport function useNotes() {\n  const tier = useTier();\n  const canSync = !!tier;\n\n  // Live Query\n  const notes = useLiveQuery(async () => {\n    const activeNotes = await db.notes\n      .filter((note) => note.deletedAt === null)\n      .sortBy(\"updatedAt\");\n    activeNotes.reverse();\n    return activeNotes.sort(\n      (a, b) => (b.isPinned ? 1 : 0) - (a.isPinned ? 1 : 0)\n    );\n  }, []);\n\n  const updateNote = async (id: string, updates: Partial<Note>) => {\n    const now = Date.now();\n    const updatedFields = { ...updates, updatedAt: now };\n\n    await db.notes.update(id, updatedFields);\n\n    if (canSync) {\n      const updatedNote = await db.notes.get(id);\n      if (updatedNote) {\n        const syncOp = {\n          id: uuidv4(),\n          entityType: \"note\" as EntityType,\n          operation: \"update\" as OperationType,\n          payload: updatedNote,\n          timestamp: now,\n        };\n        await db.syncOutbox.add(syncOp);\n        triggerSync();\n      }\n    }\n  };\n\n  const addNote = async (payload: {\n    title: string;\n    content: string;\n    folderId?: string | null;\n    isQuickNote?: boolean;\n  }) => {\n    const now = Date.now();\n    const newNote: Note = {\n      id: uuidv4(),\n      title: payload.title,\n      content: payload.content,\n      createdAt: now,\n      updatedAt: now,\n      folderId: payload.folderId || null,\n      isPinned: false,\n      isLocked: false,\n      isQuickNote: payload.isQuickNote || false,\n      deletedAt: null,\n      tags: [],\n    };\n\n    await db.notes.add(newNote);\n\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"note\" as EntityType,\n        operation: \"create\" as OperationType,\n        payload: newNote,\n        timestamp: now,\n      };\n      await db.syncOutbox.add(syncOp);\n      triggerSync();\n    }\n    return newNote;\n  };\n\n  const addQuickNote = async (payload: { title: string; content: string }) => {\n    return addNote({ ...payload, isQuickNote: true });\n  };\n\n  // Soft Delete (Files stay in S3 for recovery)\n  const deleteNote = async (id: string) => {\n    console.log(`ðŸ—‘ï¸ Moving note to trash: ${id}`);\n    return updateNote(id, { deletedAt: Date.now(), isPinned: false });\n  };\n\n  // [FIX] Hard Delete + S3 Cleanup\n  const deleteNotePermanently = async (id: string) => {\n    console.log(`ðŸ”¥ Permanently deleting note: ${id}`);\n\n    // 1. Get the note content to find attachments\n    const note = await db.notes.get(id);\n\n    if (note && note.content) {\n      try {\n        // Parse HTML to find media\n        const parser = new DOMParser();\n        const doc = parser.parseFromString(note.content, \"text/html\");\n\n        // Find images, videos, audio, and file links (anchors)\n        const mediaElements = doc.querySelectorAll(\"img, video, audio, a\");\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const deletePromises: Promise<any>[] = [];\n\n        mediaElements.forEach((el) => {\n          const src = el.getAttribute(\"src\") || el.getAttribute(\"href\");\n          // Check if it looks like a cloud storage URL (basic check)\n          if (src && src.startsWith(\"http\")) {\n            console.log(\"Deleting attachment from S3:\", src);\n            deletePromises.push(deleteFromS3(src));\n          }\n        });\n\n        // Wait for all S3 deletions\n        if (deletePromises.length > 0) {\n          await Promise.all(deletePromises);\n        }\n      } catch (error) {\n        console.error(\"Error cleaning up S3 attachments:\", error);\n      }\n    }\n\n    // 2. Delete from Dexie\n    await db.notes.delete(id);\n\n    // 3. Sync deletion\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"note\" as EntityType,\n        operation: \"delete\" as OperationType,\n        payload: { id },\n        timestamp: Date.now(),\n      };\n      await db.syncOutbox.add(syncOp);\n      triggerSync();\n    }\n  };\n\n  const recoverNote = async (id: string) => {\n    console.log(`â™»ï¸ Recovering note from trash: ${id}`);\n    return updateNote(id, { deletedAt: null });\n  };\n\n  const pinNote = (id: string) => updateNote(id, { isPinned: true });\n  const unpinNote = (id: string) => updateNote(id, { isPinned: false });\n\n  const lockNote = (id: string) => updateNote(id, { isLocked: true });\n  const unlockNote = (id: string) => updateNote(id, { isLocked: false });\n\n  const moveNoteToFolder = (id: string, folderId: string | null) =>\n    updateNote(id, { folderId });\n\n  const addTagToNote = async (id: string, tag: string) => {\n    const note = await db.notes.get(id);\n    if (!note) return;\n\n    const cleanTag = tag.trim().toLowerCase();\n    if (cleanTag && !(note.tags || []).includes(cleanTag)) {\n      return updateNote(id, { tags: [...(note.tags || []), cleanTag] });\n    }\n  };\n\n  const removeTagFromNote = async (id: string, tag: string) => {\n    const note = await db.notes.get(id);\n    if (!note) return;\n\n    const cleanTag = tag.trim().toLowerCase();\n    const newTags = (note.tags || []).filter((t) => t !== cleanTag);\n    return updateNote(id, { tags: newTags });\n  };\n\n  return {\n    notes,\n    addNote,\n    addQuickNote,\n    updateNote,\n    deleteNote,\n    deleteNotePermanently,\n    recoverNote,\n    pinNote,\n    unpinNote,\n    lockNote,\n    unlockNote,\n    moveNoteToFolder,\n    addTagToNote,\n    removeTagFromNote,\n  };\n}\n\n// --- 2. Trash Hook ---\nexport function useTrashNotes() {\n  const notes = useLiveQuery(\n    () =>\n      db.notes.filter((note) => note.deletedAt !== null).sortBy(\"deletedAt\"),\n    []\n  );\n\n  return {\n    trashedNotes: notes,\n  };\n}\n\n// --- 3. Folders Hook ---\nexport function useFolders() {\n  const tier = useTier();\n  const canSync = !!tier;\n\n  const folders = useLiveQuery(() => db.folders.orderBy(\"name\").toArray(), []);\n\n  const addFolder = async (name: string) => {\n    const now = Date.now();\n    const newFolder: Folder = {\n      id: uuidv4(),\n      name,\n      createdAt: now,\n      updatedAt: now,\n    };\n\n    await db.folders.add(newFolder);\n\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"folder\" as EntityType,\n        operation: \"create\" as OperationType,\n        payload: newFolder,\n        timestamp: now,\n      };\n      await db.syncOutbox.add(syncOp);\n      triggerSync();\n    }\n    return newFolder;\n  };\n\n  const updateFolder = async (id: string, updates: Partial<Folder>) => {\n    const now = Date.now();\n    const updatedFields = { ...updates, updatedAt: now };\n\n    await db.folders.update(id, updatedFields);\n\n    if (canSync) {\n      const updatedFolder = await db.folders.get(id);\n      if (updatedFolder) {\n        const syncOp = {\n          id: uuidv4(),\n          entityType: \"folder\" as EntityType,\n          operation: \"update\" as OperationType,\n          payload: updatedFolder,\n          timestamp: now,\n        };\n        await db.syncOutbox.add(syncOp);\n        triggerSync();\n      }\n    }\n  };\n\n  const deleteFolder = async (id: string) => {\n    const notesToMove = await db.notes.where(\"folderId\").equals(id).toArray();\n\n    await db.transaction(\"rw\", db.notes, db.folders, async () => {\n      const now = Date.now();\n      if (notesToMove.length > 0) {\n        const noteUpdates = notesToMove.map((note) => {\n          return db.notes.update(note.id, { folderId: null, updatedAt: now });\n        });\n        await Promise.all(noteUpdates);\n      }\n      await db.folders.delete(id);\n    });\n\n    if (canSync) {\n      const now = Date.now();\n      for (const note of notesToMove) {\n        const updatedNote = await db.notes.get(note.id);\n        if (updatedNote) {\n          const noteSyncOp = {\n            id: uuidv4(),\n            entityType: \"note\" as EntityType,\n            operation: \"update\" as OperationType,\n            payload: updatedNote,\n            timestamp: now,\n          };\n          await db.syncOutbox.add(noteSyncOp);\n        }\n      }\n\n      const folderSyncOp = {\n        id: uuidv4(),\n        entityType: \"folder\" as EntityType,\n        operation: \"delete\" as OperationType,\n        payload: { id },\n        timestamp: now,\n      };\n      await db.syncOutbox.add(folderSyncOp);\n      triggerSync();\n    }\n  };\n\n  return {\n    folders,\n    addFolder,\n    updateFolder,\n    deleteFolder,\n  };\n}\n\n// --- 4. Tags Hook ---\nexport function useNoteTags() {\n  const allTags = useLiveQuery(async () => {\n    const notes = await db.notes.toArray();\n    const tagSet = new Set<string>();\n    notes.forEach((note) => {\n      (note.tags || []).forEach((tag) => tagSet.add(tag));\n    });\n    return Array.from(tagSet).sort();\n  }, []);\n\n  return {\n    tags: allTags,\n  };\n}\n\n// --- 5. User Metadata Hook ---\nexport function useUserMetadata() {\n  const metadata = useLiveQuery(() => db.userMetadata.limit(1).first(), []);\n  return {\n    metadata,\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 371, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/db/useDiary.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport db, {\n  DiaryEntry,\n  OperationType,\n  EntityType,\n  DiaryWeather,\n  DiaryMedia,\n} from \"./clientDb\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { format } from \"date-fns\";\nimport { useTier } from \"./useTier\";\nimport { triggerSync } from \"../sync/syncService\";\n\n// Helper interface for the data passed from the UI\nexport interface DiaryUpdatePayload {\n  content: string;\n  mood?: string;\n  energy?: number;\n  weather?: DiaryWeather | null;\n  location?: string;\n  tags?: string[];\n  isLocked?: boolean;\n  media?: DiaryMedia[];\n}\n\nexport function useDiary() {\n  const [entries, setEntries] = useState<DiaryEntry[]>([]);\n  const tier = useTier();\n  const canSync = !!tier;\n\n  // Load diary entries from IndexedDB on mount\n  useEffect(() => {\n    const fetchEntries = async () => {\n      const allEntries = await db.diaryEntries.toArray();\n      // Sort: Newest first\n      const sorted = allEntries.sort(\n        (a, b) =>\n          new Date(b.entryDate).getTime() - new Date(a.entryDate).getTime()\n      );\n      setEntries(sorted);\n    };\n    fetchEntries();\n  }, []);\n\n  /**\n   * Save (Create or Update) an entry.\n   * @param data - The content and new fields (mood, weather, etc.)\n   * @param dateStr - Optional YYYY-MM-DD string. Defaults to TODAY if omitted.\n   */\n  const saveEntry = async (data: DiaryUpdatePayload, dateStr?: string) => {\n    // Default to today if no specific date provided\n    const targetDate = dateStr || format(new Date(), \"yyyy-MM-dd\");\n\n    const existing = entries.find((entry) => entry.entryDate === targetDate);\n    const now = Date.now();\n\n    if (existing) {\n      // --- UPDATE EXISTING ---\n\n      // Prepare the update object (merging existing data with new data)\n      const updates = {\n        content: data.content,\n        // We generally keep the original createdAt, but you could add updatedAt if needed\n        mood: data.mood,\n        energy: data.energy,\n        weather: data.weather,\n        location: data.location,\n        tags: data.tags,\n        isLocked: data.isLocked,\n        media: data.media,\n      };\n\n      // 1. Update in Local DB\n      await db.diaryEntries.update(existing.id, updates);\n\n      // 2. Update Local State\n      setEntries((prev) =>\n        prev.map((entry) =>\n          entry.id === existing.id ? { ...entry, ...updates } : entry\n        )\n      );\n\n      // 3. Sync\n      if (canSync) {\n        const fullUpdatedEntry = { ...existing, ...updates };\n        const syncOp = {\n          id: uuidv4(),\n          entityType: \"diary\" as EntityType,\n          operation: \"update\" as OperationType,\n          payload: fullUpdatedEntry,\n          timestamp: now,\n        };\n        await db.syncOutbox.add(syncOp);\n        console.log(\"ðŸ“¤ Added UPDATE diary entry to sync outbox\");\n        triggerSync();\n      }\n    } else {\n      // --- CREATE NEW ---\n\n      const newEntry: DiaryEntry = {\n        id: uuidv4(),\n        entryDate: targetDate,\n        content: data.content,\n        createdAt: now,\n        mood: data.mood,\n        energy: data.energy,\n        weather: data.weather || null,\n        location: data.location,\n        tags: data.tags || [],\n        isLocked: data.isLocked || false,\n        media: data.media || [],\n      };\n\n      // 1. Add to Local DB\n      await db.diaryEntries.add(newEntry);\n\n      // 2. Update Local State (and re-sort)\n      setEntries((prev) => {\n        const updated = [newEntry, ...prev];\n        return updated.sort(\n          (a, b) =>\n            new Date(b.entryDate).getTime() - new Date(a.entryDate).getTime()\n        );\n      });\n\n      // 3. Sync\n      if (canSync) {\n        const syncOp = {\n          id: uuidv4(),\n          entityType: \"diary\" as EntityType,\n          operation: \"create\" as OperationType,\n          payload: newEntry,\n          timestamp: now,\n        };\n        await db.syncOutbox.add(syncOp);\n        console.log(\"ðŸ“¤ Added CREATE diary entry to sync outbox\");\n        triggerSync();\n      }\n    }\n  };\n\n  const deleteDiaryEntry = async (id: string) => {\n    await db.diaryEntries.delete(id);\n    setEntries((prev) => prev.filter((entry) => entry.id !== id));\n\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"diary\" as EntityType,\n        operation: \"delete\" as OperationType,\n        payload: { id },\n        timestamp: Date.now(),\n      };\n      await db.syncOutbox.add(syncOp);\n      console.log(\"ðŸ“¤ Added DELETE diary entry to sync outbox\");\n      triggerSync();\n    }\n  };\n\n  return {\n    entries,\n    saveEntry, // âœ… Renamed to saveEntry (replaces saveTodayEntry)\n    deleteDiaryEntry,\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 517, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/db/usePomodoro.ts"],"sourcesContent":["\"use client\";\n\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport db, { PomodoroSession, OperationType, EntityType } from \"./clientDb\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { useTier } from \"./useTier\";\nimport { triggerSync } from \"../sync/syncService\";\nimport { startOfDay, endOfDay } from \"date-fns\";\n\nexport function usePomodoro() {\n  const tier = useTier();\n  const canSync = !!tier;\n\n  // âœ… 1. Live Query for TODAY'S sessions only (Auto-updates UI)\n  const todaySessions = useLiveQuery(async () => {\n    const start = startOfDay(new Date()).getTime();\n    const end = endOfDay(new Date()).getTime();\n\n    // Get sessions completed between start and end of today\n    return await db.pomodoroSessions\n      .where(\"completedAt\")\n      .between(start, end)\n      .toArray();\n  }, []);\n\n  // âœ… 2. Add Session (Offline First)\n  const addSession = async (\n    durationMinutes: number,\n    type: \"work\" | \"break\"\n  ) => {\n    const now = Date.now();\n\n    const newSession: PomodoroSession = {\n      id: uuidv4(),\n      durationMinutes,\n      completedAt: now,\n      type,\n    };\n\n    // Save locally\n    await db.pomodoroSessions.add(newSession);\n    console.log(`âœ… Saved ${type} session locally`);\n\n    // Queue for Sync\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"pomodoro\" as EntityType,\n        operation: \"create\" as OperationType,\n        payload: newSession,\n        timestamp: now,\n      };\n      await db.syncOutbox.add(syncOp);\n      triggerSync();\n    }\n  };\n\n  return {\n    todaySessions, // Returns array of today's sessions\n    addSession, // Function to log new session\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAPA;;;;;;;AASO,SAAS;IACd,MAAM,OAAO,IAAA,sIAAO;IACpB,MAAM,UAAU,CAAC,CAAC;IAElB,8DAA8D;IAC9D,MAAM,gBAAgB,IAAA,2LAAY,EAAC;QACjC,MAAM,QAAQ,IAAA,uJAAU,EAAC,IAAI,QAAQ,OAAO;QAC5C,MAAM,MAAM,IAAA,mJAAQ,EAAC,IAAI,QAAQ,OAAO;QAExC,wDAAwD;QACxD,OAAO,MAAM,uIAAE,CAAC,gBAAgB,CAC7B,KAAK,CAAC,eACN,OAAO,CAAC,OAAO,KACf,OAAO;IACZ,GAAG,EAAE;IAEL,mCAAmC;IACnC,MAAM,aAAa,OACjB,iBACA;QAEA,MAAM,MAAM,KAAK,GAAG;QAEpB,MAAM,aAA8B;YAClC,IAAI,IAAA,iLAAM;YACV;YACA,aAAa;YACb;QACF;QAEA,eAAe;QACf,MAAM,uIAAE,CAAC,gBAAgB,CAAC,GAAG,CAAC;QAC9B,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,KAAK,gBAAgB,CAAC;QAE7C,iBAAiB;QACjB,IAAI,SAAS;YACX,MAAM,SAAS;gBACb,IAAI,IAAA,iLAAM;gBACV,YAAY;gBACZ,WAAW;gBACX,SAAS;gBACT,WAAW;YACb;YACA,MAAM,uIAAE,CAAC,UAAU,CAAC,GAAG,CAAC;YACxB,IAAA,gJAAW;QACb;IACF;IAEA,OAAO;QACL;QACA;IACF;AACF","debugId":null}},
    {"offset": {"line": 579, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/app/app/dashboard/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { useTier } from \"@/lib/db/useTier\";\nimport { useTasks } from \"@/lib/db/useTasks\";\nimport { useNotes } from \"@/lib/db/useNotes\";\nimport { useDiary } from \"@/lib/db/useDiary\";\nimport { usePomodoro } from \"@/lib/db/usePomodoro\";\nimport { format } from \"date-fns\";\n\nexport default function UnifiedDashboard() {\n  const { data: session } = useSession();\n  const tier = useTier();\n  const isFree = tier === \"free\";\n\n  // Tasks\n  // âœ… 1. Get the new update and delete functions\n  const { tasks, addTask, toggleTask, updateTaskTitle, deleteTask } =\n    useTasks();\n  const [taskInput, setTaskInput] = useState(\"\");\n\n  // Notes\n  // âœ… 2. Get the new delete function\n  const { notes, addNote, deleteNote } = useNotes();\n  const [noteTitle, setNoteTitle] = useState(\"\");\n  const [noteContent, setNoteContent] = useState(\"\");\n\n  // Diary (only for paid users)\n  // âœ… 3. Get the new delete function\n  const {\n    entries: diaryEntries,\n    saveTodayEntry,\n    deleteDiaryEntry,\n  } = useDiary();\n  const [diaryContent, setDiaryContent] = useState(\"\");\n\n  const today = format(new Date(), \"yyyy-MM-dd\");\n  const todayEntry = diaryEntries.find((entry) => entry.entryDate === today);\n  useEffect(() => {\n    if (todayEntry && diaryContent === \"\") {\n      setDiaryContent(todayEntry.content);\n    }\n    // Prevent re-populating if user cleared it\n    if (!todayEntry) {\n      setDiaryContent(\"\");\n    }\n  }, [todayEntry, diaryContent]);\n\n  // Pomodoro\n  const { sessions: pomodoroSessions } = usePomodoro();\n\n  // Task limit for Free tier\n  const taskLimit = isFree ? 21 : Infinity;\n  const noteLimit = isFree ? 14 : Infinity;\n  const canAddTask = tasks.length < taskLimit;\n  const canAddNote = notes.length < noteLimit;\n\n  // Handlers\n  const handleAddTask = () => {\n    if (taskInput.trim() && canAddTask) {\n      addTask(taskInput.trim());\n      setTaskInput(\"\");\n    }\n  };\n\n  // âœ… This function already clears the inputs (lines 74-75)\n  const handleAddNote = () => {\n    if (noteTitle.trim() && canAddNote) {\n      addNote(noteTitle.trim(), noteContent);\n      setNoteTitle(\"\");\n      setNoteContent(\"\");\n    }\n  };\n\n  const handleSaveDiary = () => {\n    if (!isFree) {\n      saveTodayEntry(diaryContent);\n      // âœ… 4. Clear the diary content box after saving\n      setDiaryContent(\"\");\n    }\n  };\n\n  // âœ… 5. Add new handlers for edit/delete\n  const handleEditTask = (id: string, currentTitle: string) => {\n    const newTitle = prompt(\"Enter new task title:\", currentTitle);\n    if (newTitle && newTitle.trim() !== \"\") {\n      updateTaskTitle(id, newTitle.trim());\n    }\n  };\n\n  const handleDeleteTask = (id: string) => {\n    if (confirm(\"Are you sure you want to delete this task?\")) {\n      deleteTask(id);\n    }\n  };\n\n  const handleDeleteNote = (id: string) => {\n    if (confirm(\"Are you sure you want to delete this note?\")) {\n      deleteNote(id);\n    }\n  };\n\n  const handleDeleteDiary = (id: string) => {\n    if (confirm(\"Are you sure you want to delete today's diary entry?\")) {\n      deleteDiaryEntry(id);\n    }\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      <h2 className=\"text-2xl font-semibold text-gray-900\">\n        TaskGlyph Dashboard\n      </h2>\n\n      {/* Tier Info */}\n      <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n        <p className=\"text-blue-800\">\n          {isFree ? (\n            <span>\n              ðŸ†“ Free Tier â€” {taskLimit - tasks.length} tasks left,{\" \"}\n              {noteLimit - notes.length} notes left\n            </span>\n          ) : (\n            <span>\n              âœ¨{\" \"}\n              {tier === \"basic\"\n                ? \"Basic\"\n                : tier === \"pro\"\n                ? \"Pro\"\n                : \"Ultra Pro\"}{\" \"}\n              Tier â€” Full access\n            </span>\n          )}\n        </p>\n      </div>\n\n      {/* Tasks */}\n      <section className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n          Tasks ({tasks.length}/{taskLimit})\n        </h3>\n        {canAddTask ? (\n          <div className=\"flex gap-2 mb-4\">\n            <input\n              type=\"text\"\n              value={taskInput}\n              onChange={(e) => setTaskInput(e.target.value)}\n              placeholder=\"Add a new task...\"\n              className=\"flex-1 border border-gray-300 rounded px-3 py-2 text-gray-800\"\n              onKeyDown={(e) => e.key === \"Enter\" && handleAddTask()}\n            />\n            <button\n              onClick={handleAddTask}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\n            >\n              Add\n            </button>\n          </div>\n        ) : (\n          <p className=\"text-gray-500 mb-4\">\n            Task limit reached. Upgrade to add more.\n          </p>\n        )}\n        <ul className=\"space-y-2\">\n          {tasks.map((task) => (\n            // âœ… 6. Add flex layout to list item\n            <li\n              key={task.id}\n              className=\"flex items-center justify-between gap-3\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <input\n                  type=\"checkbox\"\n                  checked={task.completed}\n                  onChange={() => toggleTask(task.id, !task.completed)}\n                  className=\"h-4 w-4 text-blue-600 rounded\"\n                />\n                <span\n                  className={\n                    task.completed\n                      ? \"line-through text-gray-500\"\n                      : \"text-gray-900\"\n                  }\n                >\n                  {task.title}\n                </span>\n              </div>\n              {/* âœ… 7. Add Edit and Delete buttons */}\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={() => handleEditTask(task.id, task.title)}\n                  className=\"text-sm text-blue-600 hover:text-blue-800\"\n                >\n                  Edit\n                </button>\n                <button\n                  onClick={() => handleDeleteTask(task.id)}\n                  className=\"text-sm text-red-600 hover:text-red-800\"\n                >\n                  Delete\n                </button>\n              </div>\n            </li>\n          ))}\n        </ul>\n        {tasks.length === 0 && <p className=\"text-gray-500\">No tasks yet.</p>}\n      </section>\n\n      {/* Notes */}\n      <section className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n          Notes ({notes.length}/{noteLimit})\n        </h3>\n        {canAddNote ? (\n          <>\n            <input\n              type=\"text\"\n              value={noteTitle}\n              onChange={(e) => setNoteTitle(e.target.value)}\n              placeholder=\"Note title\"\n              className=\"w-full border border-gray-300 rounded px-3 py-2 mb-2 text-gray-800\"\n            />\n            <textarea\n              value={noteContent}\n              onChange={(e) => setNoteContent(e.target.value)}\n              placeholder=\"Write your note...\"\n              rows={3}\n              className=\"w-full border border-gray-300 rounded px-3 py-2 mb-3 text-gray-800\"\n            />\n            <button\n              onClick={handleAddNote}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\n            >\n              Save Note\n            </button>\n          </>\n        ) : (\n          <p className=\"text-gray-500\">\n            Note limit reached. Upgrade to add more.\n          </p>\n        )}\n        <div className=\"mt-4 space-y-2 max-h-32 overflow-y-auto\">\n          {notes.slice(0, 3).map((note) => (\n            // âœ… 8. Add flex layout to note item\n            <div\n              key={note.id}\n              className=\"flex justify-between items-center text-sm p-2 bg-gray-50 rounded\"\n            >\n              <span>\n                <strong>{note.title}</strong>: {note.content.substring(0, 60)}\n                ...\n              </span>\n              {/* âœ… 9. Add Delete button */}\n              <button\n                onClick={() => handleDeleteNote(note.id)}\n                className=\"ml-2 text-xs text-red-600 hover:text-red-800\"\n              >\n                Delete\n              </button>\n            </div>\n          ))}\n        </div>\n        {notes.length === 0 && (\n          <p className=\"text-gray-500 mt-2\">No notes yet.</p>\n        )}\n      </section>\n\n      {/* Diary â€” ONLY FOR PAID USERS */}\n      {!isFree && (\n        <section className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n            Diary â€” {format(new Date(), \"EEEE, MMMM d, yyyy\")}\n          </h3>\n          <textarea\n            value={diaryContent}\n            onChange={(e) => setDiaryContent(e.target.value)}\n            placeholder=\"Write your daily thoughts...\"\n            rows={4}\n            className=\"w-full border border-gray-300 rounded px-3 py-2 mb-3 text-gray-800\"\n          />\n          <button\n            onClick={handleSaveDiary}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\n          >\n            {todayEntry ? \"Update Entry\" : \"Save Entry\"}\n          </button>\n          {/* âœ… 10. Add Delete button for today's entry */}\n          {todayEntry && (\n            <button\n              onClick={() => handleDeleteDiary(todayEntry.id)}\n              className=\"ml-2 bg-red-100 text-red-700 px-4 py-2 rounded hover:bg-red-200\"\n            >\n              Delete Entry\n            </button>\n          )}\n        </section>\n      )}\n\n      {/* Pomodoro */}\n      <section className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n          Focus Sessions\n        </h3>\n        <p className=\"text-gray-600 mb-4\">\n          Youâ€™ve completed <strong>{pomodoroSessions.length}</strong> sessions.\n          {isFree && pomodoroSessions.length >= 21 && (\n            <span className=\"text-red-600 ml-2\">Monthly limit reached.</span>\n          )}\n        </p>\n        <a\n          href=\"/pomodoro\"\n          className=\"inline-block bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700\"\n        >\n          Start Pomodoro Timer\n        </a>\n      </section>\n\n      {/* User Info */}\n      <div className=\"text-sm text-gray-600 pt-4 border-t border-gray-200\">\n        <p>Signed in as: {session?.user?.email}</p>\n        <p className=\"mt-1\">âœ… All data syncs to cloud â€” works offline too!</p>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}
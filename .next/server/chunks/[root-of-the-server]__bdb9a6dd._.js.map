{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/app/api/ai/insights/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\n\nconst genAI = new GoogleGenerativeAI(process.env.GOOGLE_API_KEY!);\n\nexport async function POST(req: Request) {\n  try {\n    const { tasks, sessions, diary, timeframe } = await req.json();\n\n    const prompt = `\n      Act as an elite Productivity Data Scientist for 'TaskGlyph'.\n      Analyze the user's ${timeframe.toUpperCase()} data:\n\n      DATA:\n      - Tasks: ${tasks.completed} done, ${tasks.overdue} overdue.\n      - Focus: ${sessions.totalMinutes} mins.\n      - Mood: ${diary.mood || \"Neutral\"}, Energy: ${diary.energy || 5}/10.\n\n      RETURN JSON (no markdown) with these 9 keys:\n      1. \"score\": (0-100) Productivity Score.\n      2. \"analysis\": Deep insight into their workflow patterns (2 sentences).\n      3. \"action\": Specific command for next session.\n      4. \"burnout_risk\": \"Low\", \"Medium\", or \"High\".\n      5. \"peak_hours\": Best 2hr window (e.g. \"9AM-11AM\").\n      6. \"hidden_pattern\": One subtle habit noticed.\n      7. \"sustainability\": \"Sustainable\", \"Overload\", or \"Underload\".\n      8. \"momentum\": \"Rising ðŸš€\", \"Falling ðŸ“‰\", or \"Stable âž–\".\n      9. \"work_mode\": Classify their style today (e.g., \"Sniper\", \"Grinder\", \"Explorer\", \"Scatter\").\n\n      Tone: Futuristic, precise, data-driven.\n    `;\n\n    // Use the stable Flash model\n    const model = genAI.getGenerativeModel({ model: \"gemini-2.5-flash\" });\n\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    const text = response.text();\n\n    const cleanJson = text.replace(/```json|```/g, \"\").trim();\n    const data = JSON.parse(cleanJson);\n\n    return NextResponse.json(data);\n  } catch (error) {\n    console.error(\"AI Error:\", error);\n    return NextResponse.json(\n      {\n        score: 0,\n        analysis: \"Neural link unstable.\",\n        action: \"Standby.\",\n        burnout_risk: \"Low\",\n        peak_hours: \"--\",\n        hidden_pattern: \"--\",\n        sustainability: \"--\",\n        momentum: \"--\",\n        work_mode: \"--\",\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,QAAQ,IAAI,sLAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc;AAExD,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,MAAM,IAAI,IAAI;QAE5D,MAAM,SAAS,CAAC;;yBAEK,EAAE,UAAU,WAAW,GAAG;;;eAGpC,EAAE,MAAM,SAAS,CAAC,OAAO,EAAE,MAAM,OAAO,CAAC;eACzC,EAAE,SAAS,YAAY,CAAC;cACzB,EAAE,MAAM,IAAI,IAAI,UAAU,UAAU,EAAE,MAAM,MAAM,IAAI,EAAE;;;;;;;;;;;;;;IAclE,CAAC;QAED,6BAA6B;QAC7B,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAmB;QAEnE,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,MAAM,OAAO,SAAS,IAAI;QAE1B,MAAM,YAAY,KAAK,OAAO,CAAC,gBAAgB,IAAI,IAAI;QACvD,MAAM,OAAO,KAAK,KAAK,CAAC;QAExB,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,aAAa;QAC3B,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,UAAU;YACV,QAAQ;YACR,cAAc;YACd,YAAY;YACZ,gBAAgB;YAChB,gBAAgB;YAChB,UAAU;YACV,WAAW;QACb,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}
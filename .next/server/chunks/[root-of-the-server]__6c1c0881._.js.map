{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/db/serverDb.ts"],"sourcesContent":["import { Pool } from \"pg\";\n\nconst globalForPg = global as unknown as { pgPool: Pool | undefined };\n\nconst pool =\n  globalForPg.pgPool ??\n  new Pool({\n    connectionString: process.env.DATABASE_URL,\n    ssl: {\n      rejectUnauthorized: false,\n    },\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPg.pgPool = pool;\n}\n\nexport default pool;\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM;AAEN,MAAM,OACJ,YAAY,MAAM,IAClB,IAAI,4GAAI,CAAC;IACP,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK;QACH,oBAAoB;IACtB;AACF;AAEF,wCAA2C;IACzC,YAAY,MAAM,GAAG;AACvB;uCAEe","debugId":null}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/auth/options.ts"],"sourcesContent":["import type { NextAuthOptions, User } from \"next-auth\"; // Import User type\nimport GoogleProvider from \"next-auth/providers/google\";\nimport CredentialsProvider from \"next-auth/providers/credentials\"; // 1. Import CredentialsProvider\nimport pool from \"@/lib/db/serverDb\";\nimport bcrypt from \"bcrypt\"; // 2. Import bcrypt\n\nexport const authOptions: NextAuthOptions = {\n  providers: [\n    GoogleProvider({\n      clientId: process.env.GOOGLE_CLIENT_ID || \"\",\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"\",\n    }),\n    // 3. Add CredentialsProvider\n    CredentialsProvider({\n      name: \"Email & Password\",\n      credentials: {\n        email: {\n          label: \"Email\",\n          type: \"email\",\n          placeholder: \"you@example.com\",\n        },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials): Promise<User | null> {\n        // Check if credentials are provided\n        if (!credentials?.email || !credentials?.password) {\n          console.error(\"Credentials missing\");\n          return null;\n        }\n\n        try {\n          // Find user by email in your Neon DB\n          const { rows } = await pool.query(\n            \"SELECT id, email, name, password FROM users WHERE email = $1\",\n            [credentials.email.toLowerCase()] // Normalize email to lowercase\n          );\n\n          if (rows.length === 0) {\n            console.log(\"No user found with that email\");\n            return null; // User not found\n          }\n\n          const user = rows[0];\n\n          // Check if user signed up with Google (no password)\n          if (!user.password) {\n            console.log(\n              \"User signed up via Google, password login not possible\"\n            );\n            // Optionally: You could throw an error here to give specific feedback\n            // throw new Error(\"Please sign in using Google.\");\n            return null;\n          }\n\n          // Verify the password using bcrypt\n          const passwordIsValid = await bcrypt.compare(\n            credentials.password,\n            user.password // The hashed password from your DB\n          );\n\n          if (!passwordIsValid) {\n            console.log(\"Invalid password\");\n            return null; // Incorrect password\n          }\n\n          console.log(\"✅ Password validation successful for:\", user.email);\n\n          // Return the user object (must include id, can include name, email)\n          // NextAuth uses this object to create the session/token\n          return {\n            id: user.id,\n            name: user.name,\n            email: user.email,\n          };\n        } catch (error) {\n          console.error(\"❌ DB error during authorization:\", error);\n          return null; // Return null on error\n        }\n      },\n    }),\n  ],\n\n  session: {\n    strategy: \"jwt\",\n  },\n\n  secret: process.env.NEXTAUTH_SECRET,\n\n  pages: {\n    signIn: \"/auth/signin\",\n    // You might want to add error page:\n    // error: '/auth/error',\n  },\n\n  callbacks: {\n    async jwt({ token, user }) {\n      // Persist the user ID from either Google or Credentials login to the token\n      if (user) {\n        token.id = user.id;\n      }\n      return token;\n    },\n\n    async session({ session, token }) {\n      if (session.user && token.id) {\n        // Ensure token.id exists\n        session.user.id = token.id as string;\n      }\n      return session;\n    },\n\n    async signIn({ user, account }) {\n      // Google sign-in logic (remains the same)\n      if (account?.provider === \"google\" && user.email) {\n        const userId = user.id as string;\n        try {\n          const { rows } = await pool.query(\n            \"SELECT id FROM users WHERE id = $1\",\n            [userId]\n          );\n          if (rows.length === 0) {\n            await pool.query(\n              `INSERT INTO users (id, email, name, tier)\n               VALUES ($1, $2, $3, $4)`,\n              [userId, user.email, user.name || null, \"free\"]\n            );\n            console.log(\"✅ New Google user created:\", userId);\n          }\n        } catch (error) {\n          console.error(\"❌ DB error during Google sign-in:\", error);\n          return false;\n        }\n      }\n\n      return true;\n    },\n  },\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 301, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/app/api/sync/route.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { NextResponse, NextRequest } from \"next/server\";\nimport { getServerSession } from \"next-auth\";\nimport { authOptions } from \"@/lib/auth/options\";\nimport pool from \"@/lib/db/serverDb\";\nimport { PoolClient } from \"pg\"; // Import the PoolClient type\n\n// --- [GET FUNCTION] ---\nexport async function GET(request: NextRequest) {\n  const session = await getServerSession(authOptions);\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { searchParams } = new URL(request.url);\n  const since = searchParams.get(\"since\") || \"0\";\n  const userId = session.user.id;\n\n  // ✅ --- [THE FIX] ---\n  let client: PoolClient | undefined;\n\n  try {\n    // 1. Move the connection *inside* the try block.\n    client = await pool.connect();\n\n    await client.query(\"BEGIN\"); // Start a transaction\n    // ✅ --- END OF FIX ---\n\n    const syncTimestamp = Date.now();\n\n    const [\n      userMetadataRes,\n      projectsRes,\n      tasksRes,\n      notesRes,\n      foldersRes,\n      diaryEntriesRes,\n      pomodoroSessionsRes,\n      notificationsRes,\n    ] = await Promise.all([\n      // 1. userMetadata\n      client.query(\n        `\n          SELECT \n            id as \"userId\", \n            tier,\n            trial_started_at as \"trialStartedAt\",\n            (notes_password_hash IS NOT NULL) as \"hasNotesPassword\"\n          FROM users \n          WHERE id = $1\n        `,\n        [userId]\n      ),\n      // 2. projects\n      client.query(\n        `\n          SELECT \n            id, name, description,\n            accent_color as \"accentColor\",\n            created_at as \"createdAt\",\n            updated_at as \"updatedAt\"\n          FROM projects \n          WHERE user_id = $1 AND updated_at > $2\n        `,\n        [userId, since]\n      ),\n      // 3. tasks\n      client.query(\n        `\n          SELECT \n            id, title, completed, notes, priority, tags, meet_link,\n            created_at as \"createdAt\",\n            updated_at as \"updatedAt\",\n            project_id as \"projectId\",\n            parent_id as \"parentId\",\n            due_date as \"dueDate\",\n            recurring_schedule as \"recurringSchedule\",\n            reminder_at as \"reminderAt\",\n            reminder_30_sent,\n            reminder_20_sent,\n            reminder_10_sent\n          FROM tasks \n          WHERE user_id = $1 AND updated_at > $2\n        `,\n        [userId, since]\n      ),\n      // 4. notes\n      client.query(\n        `\n          SELECT \n            id, title, content, tags,\n            created_at as \"createdAt\",\n            updated_at as \"updatedAt\",\n            folder_id as \"folderId\",\n            is_pinned as \"isPinned\",\n            is_locked as \"isLocked\",\n            is_quick_note as \"isQuickNote\",\n            deleted_at as \"deletedAt\"\n          FROM notes \n          WHERE user_id = $1 AND updated_at > $2\n        `,\n        [userId, since]\n      ),\n      // 5. folders\n      client.query(\n        `\n          SELECT \n            id, name,\n            created_at as \"createdAt\",\n            updated_at as \"updatedAt\"\n          FROM folders \n          WHERE user_id = $1 AND updated_at > $2\n        `,\n        [userId, since]\n      ),\n      // 6. [UPDATED] diary_entries with New Fields\n      client.query(\n        `\n          SELECT \n            id, content,\n            entry_date as \"entryDate\",\n            created_at as \"createdAt\",\n            mood,\n            energy,\n            weather,\n            location,\n            tags,\n            is_locked as \"isLocked\",\n            media\n          FROM diary_entries \n          WHERE user_id = $1 AND created_at > $2\n        `,\n        [userId, since]\n      ),\n      // 7. pomodoro_sessions\n      client.query(\n        `\n          SELECT \n            id, type,\n            duration_minutes as \"durationMinutes\",\n            completed_at as \"completedAt\"\n          FROM pomodoro_sessions \n          WHERE user_id = $1 AND completed_at > $2\n        `,\n        [userId, since]\n      ),\n      // 8. notifications\n      client.query(\n        `\n          SELECT \n            id, message, link, read,\n            user_id as \"userId\",\n            (EXTRACT(EPOCH FROM created_at) * 1000) as \"createdAt\"\n          FROM notifications \n          WHERE user_id = $1 AND (EXTRACT(EPOCH FROM created_at) * 1000) > $2\n        `,\n        [userId, since]\n      ),\n    ]);\n\n    await client.query(\"COMMIT\"); // Commit the transaction\n\n    // Return all data in a single JSON object\n    return NextResponse.json({\n      timestamp: syncTimestamp,\n      userMetadata: userMetadataRes.rows,\n      projects: projectsRes.rows,\n      tasks: tasksRes.rows,\n      notes: notesRes.rows,\n      folders: foldersRes.rows,\n      // [UPDATED] Parse JSON strings for Weather and Media before sending to client\n      diaryEntries: diaryEntriesRes.rows.map((row) => ({\n        ...row,\n        weather: row.weather ? JSON.parse(row.weather) : null,\n        media: row.media ? JSON.parse(row.media) : [],\n      })),\n      pomodoroSessions: pomodoroSessionsRes.rows,\n      notifications: notificationsRes.rows,\n    });\n  } catch (error: any) {\n    // ✅ [FIX] Rollback only if client exists\n    if (client) {\n      await client.query(\"ROLLBACK\"); // Roll back on error\n    }\n    console.error(\"Failed to fetch all data for user:\", userId, error);\n    return NextResponse.json(\n      { error: \"Failed to fetch data: \" + error.message },\n      { status: 500 }\n    );\n  } finally {\n    // ✅ [FIX] Always release the client if it was connected\n    if (client) {\n      client.release();\n    }\n  }\n}\n\n// --- [POST FUNCTION] ---\n\ntype SyncOperation = {\n  id: string;\n  entityType:\n    | \"task\"\n    | \"project\"\n    | \"note\"\n    | \"diary\"\n    | \"pomodoro\"\n    | \"notification\"\n    | \"folder\";\n  operation: \"create\" | \"update\" | \"delete\";\n  payload: any;\n  timestamp: number;\n};\n\nexport async function POST(request: NextRequest) {\n  const session = await getServerSession(authOptions);\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const userId = session.user.id;\n\n  let operations: SyncOperation[];\n  try {\n    const body = await request.json();\n    operations = body.operations;\n    if (!Array.isArray(operations)) {\n      throw new Error(\"Invalid operations format\");\n    }\n  } catch (error) {\n    return NextResponse.json(\n      { error: \"Invalid request body: \" + (error as Error).message },\n      { status: 400 }\n    );\n  }\n\n  const results: { id: string; success: boolean; error?: string }[] = [];\n\n  // ✅ --- [THE FIX] ---\n  let client: PoolClient | undefined;\n\n  try {\n    // 1. Move connection inside the try block\n    client = await pool.connect();\n    // ✅ --- END OF FIX ---\n\n    const { rows: userRows } = await client.query(\n      \"SELECT tier FROM users WHERE id = $1\",\n      [userId]\n    );\n\n    if (userRows.length === 0) {\n      // client.release() will be handled in 'finally'\n      return NextResponse.json({ error: \"User not found\" }, { status: 404 });\n    }\n\n    const tier = userRows[0].tier;\n    await client.query(\"BEGIN\");\n\n    for (const op of operations) {\n      try {\n        let query = \"\";\n        let values: any[] = [];\n\n        switch (op.entityType) {\n          // --- 'project' case\n          case \"project\":\n            if (op.operation === \"create\") {\n              query = `\n                INSERT INTO projects (\n                  id, user_id, name, description, accent_color, created_at, updated_at\n                ) VALUES ($1, $2, $3, $4, $5, $6, $7)\n                ON CONFLICT (id) DO NOTHING\n              `;\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.name,\n                op.payload.description || null,\n                op.payload.accentColor || null,\n                op.payload.createdAt,\n                op.payload.updatedAt,\n              ];\n            } else if (op.operation === \"update\") {\n              query = `\n                UPDATE projects \n                SET name = $1, description = $2, accent_color = $3, updated_at = $4\n                WHERE id = $5 AND user_id = $6\n              `;\n              values = [\n                op.payload.name,\n                op.payload.description || null,\n                op.payload.accentColor || null,\n                op.payload.updatedAt,\n                op.payload.id,\n                userId,\n              ];\n            } else if (op.operation === \"delete\") {\n              query = `DELETE FROM projects WHERE id = $1 AND user_id = $2`;\n              values = [op.payload.id, userId];\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          // 'task' case\n          case \"task\":\n            if (op.operation === \"create\") {\n              if (tier === \"free\") {\n                const { rows } = await client.query(\n                  \"SELECT COUNT(*) FROM tasks WHERE user_id = $1\",\n                  [userId]\n                );\n                const count = parseInt(rows[0].count);\n                if (count >= 21) {\n                  results.push({\n                    id: op.id,\n                    success: false,\n                    error: \"Free tier task limit reached (21 tasks)\",\n                  });\n                  continue;\n                }\n              }\n\n              query = `\n                INSERT INTO tasks (\n                  id, user_id, title, completed, created_at, updated_at,\n                  project_id, parent_id, notes, due_date, priority, tags,\n                  recurring_schedule, reminder_at,\n                  meet_link, reminder_30_sent, reminder_20_sent, reminder_10_sent\n                ) VALUES (\n                  $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14,\n                  $15, $16, $17, $18\n                )\n                ON CONFLICT (id) DO NOTHING\n              `;\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.title,\n                op.payload.completed,\n                op.payload.createdAt,\n                op.payload.updatedAt,\n                op.payload.projectId || null,\n                op.payload.parentId || null,\n                op.payload.notes || null,\n                op.payload.dueDate || null,\n                op.payload.priority || \"none\",\n                op.payload.tags || [],\n                op.payload.recurringSchedule || \"none\",\n                op.payload.reminderAt || null,\n                op.payload.meetLink || null,\n                op.payload.reminder_30_sent || false,\n                op.payload.reminder_20_sent || false,\n                op.payload.reminder_10_sent || false,\n              ];\n            } else if (op.operation === \"update\") {\n              query = `\n                UPDATE tasks \n                SET \n                  title = $1, completed = $2, updated_at = $3,\n                  project_id = $4, parent_id = $5, notes = $6,\n                  due_date = $7, priority = $8, tags = $9,\n                  recurring_schedule = $10, reminder_at = $11,\n                  meet_link = $12, reminder_30_sent = $13,\n                  reminder_20_sent = $14, reminder_10_sent = $15\n                WHERE id = $16 AND user_id = $17\n              `;\n              values = [\n                op.payload.title,\n                op.payload.completed,\n                op.payload.updatedAt,\n                op.payload.projectId || null,\n                op.payload.parentId || null,\n                op.payload.notes || null,\n                op.payload.dueDate || null,\n                op.payload.priority || \"none\",\n                op.payload.tags || [],\n                op.payload.recurringSchedule || \"none\",\n                op.payload.reminderAt || null,\n                op.payload.meetLink || null,\n                op.payload.reminder_30_sent || false,\n                op.payload.reminder_20_sent || false,\n                op.payload.reminder_10_sent || false,\n                op.payload.id,\n                userId,\n              ];\n            } else if (op.operation === \"delete\") {\n              query = `DELETE FROM tasks WHERE id = $1 AND user_id = $2`;\n              values = [op.payload.id, userId];\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          // 'note' case\n          case \"note\":\n            if (op.operation === \"create\") {\n              if (tier === \"free\") {\n                const { rows } = await client.query(\n                  \"SELECT COUNT(*) FROM notes WHERE user_id = $1\",\n                  [userId]\n                );\n                const count = parseInt(rows[0].count);\n                if (count >= 14) {\n                  results.push({\n                    id: op.id,\n                    success: false,\n                    error: \"Free tier note limit reached\",\n                  });\n                  continue;\n                }\n              }\n              query = `\n                INSERT INTO notes (\n                  id, user_id, title, content, created_at, updated_at,\n                  folder_id, is_pinned, is_locked, is_quick_note, deleted_at,\n                  tags\n                ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)\n                ON CONFLICT (id) DO NOTHING\n              `;\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.title,\n                op.payload.content,\n                op.payload.createdAt,\n                op.payload.updatedAt,\n                op.payload.folderId || null,\n                op.payload.isPinned || false,\n                op.payload.isLocked || false,\n                op.payload.isQuickNote || false,\n                op.payload.deletedAt || null,\n                op.payload.tags || [],\n              ];\n            } else if (op.operation === \"update\") {\n              query = `\n                UPDATE notes \n                SET \n                  title = $1, content = $2, updated_at = $3,\n                  folder_id = $4, is_pinned = $5, is_locked = $6,\n                  is_quick_note = $7, deleted_at = $8,\n                  tags = $9\n                WHERE id = $10 AND user_id = $11\n              `;\n              values = [\n                op.payload.title,\n                op.payload.content,\n                op.payload.updatedAt,\n                op.payload.folderId || null,\n                op.payload.isPinned || false,\n                op.payload.isLocked || false,\n                op.payload.isQuickNote || false,\n                op.payload.deletedAt || null,\n                op.payload.tags || [],\n                op.payload.id,\n                userId,\n              ];\n            } else if (op.operation === \"delete\") {\n              query = `DELETE FROM notes WHERE id = $1 AND user_id = $2`;\n              values = [op.payload.id, userId];\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          // 'folder' case\n          case \"folder\":\n            if (op.operation === \"create\") {\n              query = `\n                INSERT INTO folders (id, user_id, name, created_at, updated_at)\n                VALUES ($1, $2, $3, $4, $5)\n                ON CONFLICT (id) DO NOTHING\n              `;\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.name,\n                op.payload.createdAt,\n                op.payload.updatedAt,\n              ];\n            } else if (op.operation === \"update\") {\n              query = `\n                UPDATE folders\n                SET name = $1, updated_at = $2\n                WHERE id = $3 AND user_id = $4\n              `;\n              values = [\n                op.payload.name,\n                op.payload.updatedAt,\n                op.payload.id,\n                userId,\n              ];\n            } else if (op.operation === \"delete\") {\n              query = `DELETE FROM folders WHERE id = $1 AND user_id = $2`;\n              values = [op.payload.id, userId];\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          // ✅ [UPDATED] 'diary' case\n          case \"diary\":\n            if (tier === \"free\") {\n              results.push({\n                id: op.id,\n                success: false,\n                error: \"Diary not available on Free tier\",\n              });\n              continue;\n            }\n            if (op.operation === \"create\" || op.operation === \"update\") {\n              query = `\n                INSERT INTO diary_entries (\n                  id, user_id, entry_date, content, created_at,\n                  mood, energy, weather, location, tags, is_locked, media\n                ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)\n                ON CONFLICT (id) DO UPDATE SET \n                  content = $4, \n                  created_at = $5,\n                  mood = $6,\n                  energy = $7,\n                  weather = $8,\n                  location = $9,\n                  tags = $10,\n                  is_locked = $11,\n                  media = $12\n              `;\n\n              // Ensure JSON fields are stringified for TEXT columns\n              const weatherStr = op.payload.weather\n                ? JSON.stringify(op.payload.weather)\n                : null;\n              const mediaStr = op.payload.media\n                ? JSON.stringify(op.payload.media)\n                : null;\n\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.entryDate,\n                op.payload.content,\n                op.payload.createdAt,\n                // New Fields\n                op.payload.mood || null,\n                op.payload.energy || null,\n                weatherStr,\n                op.payload.location || null,\n                op.payload.tags || [],\n                op.payload.isLocked || false,\n                mediaStr,\n              ];\n            } else if (op.operation === \"delete\") {\n              query = `DELETE FROM diary_entries WHERE id = $1 AND user_id = $2`;\n              values = [op.payload.id, userId];\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          // 'pomodoro' case\n          case \"pomodoro\":\n            if (op.operation === \"create\") {\n              if (tier === \"free\") {\n                const { rows } = await client.query(\n                  `SELECT COUNT(*) FROM pomodoro_sessions WHERE user_id = $1 AND DATE_TRUNC('month', TO_TIMESTAMP(completed_at / 1000)) = DATE_TRUNC('month', NOW())`,\n                  [userId]\n                );\n                const count = parseInt(rows[0].count);\n                if (count >= 21) {\n                  results.push({\n                    id: op.id,\n                    success: false,\n                    error: \"Free tier Pomodoro limit reached\",\n                  });\n                  continue;\n                }\n              }\n              query = `INSERT INTO pomodoro_sessions (id, user_id, duration_minutes, completed_at, type) VALUES ($1, $2, $3, $4, $5) ON CONFLICT (id) DO NOTHING`;\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.durationMinutes,\n                op.payload.completedAt,\n                op.payload.type || \"work\",\n              ];\n            } else if (op.operation === \"delete\") {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          // 'notification' case\n          case \"notification\":\n            if (op.operation === \"create\") {\n              query = `\n                INSERT INTO notifications (id, user_id, message, link, read, created_at)\n                VALUES ($1, $2, $3, $4, $5, NOW())\n                ON CONFLICT (id) DO NOTHING\n              `;\n              values = [\n                op.payload.id,\n                userId,\n                op.payload.message,\n                op.payload.link || null,\n                op.payload.read || false,\n              ];\n            } else if (op.operation === \"update\") {\n              query = `\n                UPDATE notifications \n                SET read = $1\n                WHERE id = $2 AND user_id = $3\n              `;\n              values = [op.payload.read, op.payload.id, userId];\n            } else if (op.operation === \"delete\") {\n              query = `DELETE FROM notifications WHERE id = $1 AND user_id = $2`;\n              values = [op.payload.id, userId];\n            } else {\n              throw new Error(\n                `Unsupported operation \"${op.operation}\" for entity \"${op.entityType}\"`\n              );\n            }\n            break;\n\n          default:\n            throw new Error(`Unsupported entity type: ${op.entityType}`);\n        }\n\n        if (query) {\n          await client.query(query, values);\n        }\n\n        results.push({ id: op.id, success: true });\n      } catch (error: any) {\n        console.error(\"Sync error for operation\", op.id, error);\n        results.push({ id: op.id, success: false, error: error.message });\n        throw new Error(`Operation ${op.id} failed: ${error.message}`);\n      }\n    }\n\n    await client.query(\"COMMIT\");\n\n    return NextResponse.json({ results });\n  } catch (error: any) {\n    // ✅ [FIX] Rollback only if client exists\n    if (client) {\n      await client.query(\"ROLLBACK\");\n    }\n    console.error(\n      \"A critical sync error occurred, transaction rolled back:\",\n      error\n    );\n\n    if (results.some((r) => !r.success)) {\n      return NextResponse.json({ results }, { status: 400 });\n    }\n    return NextResponse.json(\n      { error: \"Sync failed. Check server logs.\" },\n      { status: 500 }\n    );\n  } finally {\n    // ✅ [FIX] Always release the client if it was connected\n    if (client) {\n      client.release();\n    }\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}
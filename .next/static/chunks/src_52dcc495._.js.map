{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/lib/db/useNotes.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport db, { Note, OperationType, EntityType } from \"./clientDb\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { useTier } from \"./useTier\";\nimport { triggerSync } from \"../sync/syncService\"; // âœ… 1. Import the trigger\n\nexport function useNotes() {\n  const [notes, setNotes] = useState<Note[]>([]);\n  const tier = useTier();\n  const canSync = !!tier;\n  // Load notes from IndexedDB on mount\n  useEffect(() => {\n    const fetchNotes = async () => {\n      const allNotes = await db.notes.toArray();\n      setNotes(allNotes);\n    };\n    fetchNotes();\n  }, []);\n\n  // Add a new note\n  const addNote = async (title: string, content: string) => {\n    const newNote: Note = {\n      id: uuidv4(),\n      title,\n      content,\n      createdAt: Date.now(),\n      updatedAt: Date.now(),\n    };\n    await db.notes.add(newNote);\n    setNotes((prev) => [...prev, newNote]);\n\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"note\" as EntityType,\n        operation: \"create\" as OperationType,\n        payload: newNote,\n        timestamp: Date.now(),\n      };\n      await db.syncOutbox.add(syncOp);\n      console.log(\"ðŸ“¤ Added CREATE note to sync outbox\");\n      triggerSync(); // Poke the sync service\n    }\n\n    return newNote;\n  };\n\n  // Update an existing note\n  const updateNote = async (id: string, updates: Partial<Note>) => {\n    const now = Date.now();\n    const updatedFields = { ...updates, updatedAt: now };\n    await db.notes.update(id, updatedFields);\n    setNotes((prev) =>\n      prev.map((note) =>\n        note.id === id ? { ...note, ...updatedFields } : note\n      )\n    );\n\n    if (canSync) {\n      // âœ… We find the note *after* updating state for consistency\n      const updatedNote = notes\n        .map((note) => (note.id === id ? { ...note, ...updatedFields } : note))\n        .find((n) => n.id === id);\n\n      if (updatedNote) {\n        const syncOp = {\n          id: uuidv4(),\n          entityType: \"note\" as EntityType,\n          operation: \"update\" as OperationType,\n          payload: updatedNote, // Send the full updated note\n          timestamp: Date.now(),\n        };\n        await db.syncOutbox.add(syncOp);\n        console.log(\"ðŸ“¤ Added UPDATE note to sync outbox\");\n        triggerSync(); // Poke the sync service\n      }\n    }\n  };\n\n  // âœ… --- NEW FUNCTION: Delete Note ---\n  const deleteNote = async (id: string) => {\n    await db.notes.delete(id);\n    setNotes((prev) => prev.filter((note) => note.id !== id));\n\n    if (canSync) {\n      const syncOp = {\n        id: uuidv4(),\n        entityType: \"note\" as EntityType,\n        operation: \"delete\" as OperationType,\n        payload: { id }, // For a delete, we only need the ID\n        timestamp: Date.now(),\n      };\n      await db.syncOutbox.add(syncOp);\n      console.log(\"ðŸ“¤ Added DELETE note to sync outbox\");\n      triggerSync();\n    }\n  };\n\n  return {\n    notes,\n    addNote,\n    updateNote,\n    deleteNote, // âœ… Export the new function\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA,uOAAmD,0BAA0B;;AAN7E;;;;;;AAQO,SAAS;;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAS,EAAE;IAC7C,MAAM,OAAO,IAAA,yIAAO;IACpB,MAAM,UAAU,CAAC,CAAC;IAClB,qCAAqC;IACrC,IAAA,0KAAS;8BAAC;YACR,MAAM;iDAAa;oBACjB,MAAM,WAAW,MAAM,0IAAE,CAAC,KAAK,CAAC,OAAO;oBACvC,SAAS;gBACX;;YACA;QACF;6BAAG,EAAE;IAEL,iBAAiB;IACjB,MAAM,UAAU,OAAO,OAAe;QACpC,MAAM,UAAgB;YACpB,IAAI,IAAA,4KAAM;YACV;YACA;YACA,WAAW,KAAK,GAAG;YACnB,WAAW,KAAK,GAAG;QACrB;QACA,MAAM,0IAAE,CAAC,KAAK,CAAC,GAAG,CAAC;QACnB,SAAS,CAAC,OAAS;mBAAI;gBAAM;aAAQ;QAErC,IAAI,SAAS;YACX,MAAM,SAAS;gBACb,IAAI,IAAA,4KAAM;gBACV,YAAY;gBACZ,WAAW;gBACX,SAAS;gBACT,WAAW,KAAK,GAAG;YACrB;YACA,MAAM,0IAAE,CAAC,UAAU,CAAC,GAAG,CAAC;YACxB,QAAQ,GAAG,CAAC;YACZ,IAAA,mJAAW,KAAI,wBAAwB;QACzC;QAEA,OAAO;IACT;IAEA,0BAA0B;IAC1B,MAAM,aAAa,OAAO,IAAY;QACpC,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,gBAAgB;YAAE,GAAG,OAAO;YAAE,WAAW;QAAI;QACnD,MAAM,0IAAE,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI;QAC1B,SAAS,CAAC,OACR,KAAK,GAAG,CAAC,CAAC,OACR,KAAK,EAAE,KAAK,KAAK;oBAAE,GAAG,IAAI;oBAAE,GAAG,aAAa;gBAAC,IAAI;QAIrD,IAAI,SAAS;YACX,4DAA4D;YAC5D,MAAM,cAAc,MACjB,GAAG,CAAC,CAAC,OAAU,KAAK,EAAE,KAAK,KAAK;oBAAE,GAAG,IAAI;oBAAE,GAAG,aAAa;gBAAC,IAAI,MAChE,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;YAExB,IAAI,aAAa;gBACf,MAAM,SAAS;oBACb,IAAI,IAAA,4KAAM;oBACV,YAAY;oBACZ,WAAW;oBACX,SAAS;oBACT,WAAW,KAAK,GAAG;gBACrB;gBACA,MAAM,0IAAE,CAAC,UAAU,CAAC,GAAG,CAAC;gBACxB,QAAQ,GAAG,CAAC;gBACZ,IAAA,mJAAW,KAAI,wBAAwB;YACzC;QACF;IACF;IAEA,sCAAsC;IACtC,MAAM,aAAa,OAAO;QACxB,MAAM,0IAAE,CAAC,KAAK,CAAC,MAAM,CAAC;QACtB,SAAS,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK;QAErD,IAAI,SAAS;YACX,MAAM,SAAS;gBACb,IAAI,IAAA,4KAAM;gBACV,YAAY;gBACZ,WAAW;gBACX,SAAS;oBAAE;gBAAG;gBACd,WAAW,KAAK,GAAG;YACrB;YACA,MAAM,0IAAE,CAAC,UAAU,CAAC,GAAG,CAAC;YACxB,QAAQ,GAAG,CAAC;YACZ,IAAA,mJAAW;QACb;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;IACF;AACF;GAlGgB;;QAED,yIAAO","debugId":null}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///Users/ramanakumar/TaskGlyph/src/app/app/notes/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useNotes } from \"@/lib/db/useNotes\";\n\nexport default function NotesPage() {\n  // âœ… 1. Get updateNote and deleteNote\n  const { notes, addNote, updateNote, deleteNote } = useNotes();\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n\n  const handleAdd = () => {\n    if (title.trim()) {\n      addNote(title.trim(), content);\n      // These lines already clear the inputs, which is perfect\n      setTitle(\"\");\n      setContent(\"\");\n    }\n  };\n\n  // âœ… 2. Add handlers for Edit and Delete\n  const handleEdit = (\n    id: string,\n    currentTitle: string,\n    currentContent: string\n  ) => {\n    const newTitle = prompt(\"Enter new title:\", currentTitle);\n    if (newTitle === null) return; // User cancelled\n\n    const newContent = prompt(\"Enter new content:\", currentContent);\n    if (newContent === null) return; // User cancelled\n\n    updateNote(id, { title: newTitle.trim(), content: newContent });\n  };\n\n  const handleDelete = (id: string) => {\n    if (confirm(\"Are you sure you want to delete this note?\")) {\n      deleteNote(id);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4\">\n      <div className=\"max-w-3xl mx-auto\">\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">Notes</h1>\n\n        {/* Add Note Form */}\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8\">\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">New Note</h2>\n          <input\n            type=\"text\"\n            value={title}\n            onChange={(e) => setTitle(e.target.value)}\n            placeholder=\"Note title\"\n            className=\"w-full border border-gray-300 rounded px-3 py-2 mb-4 text-gray-800\"\n          />\n          <textarea\n            value={content}\n            onChange={(e) => setContent(e.target.value)}\n            placeholder=\"Write your note in Markdown...\"\n            rows={6}\n            className=\"w-full border border-gray-300 rounded px-3 py-2 text-gray-800 mb-4\"\n          />\n          <button\n            onClick={handleAdd}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\n          >\n            Save Note\n          </button>\n        </div>\n\n        {/* Notes List */}\n        <div className=\"space-y-6\">\n          {notes\n            // Sort by most recently updated\n            .sort((a, b) => b.updatedAt - a.updatedAt)\n            .map((note) => (\n              <div\n                key={note.id}\n                className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\"\n              >\n                {/* âœ… 3. Add flex row for Title and buttons */}\n                <div className=\"flex justify-between items-center mb-2\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">\n                    {note.title}\n                  </h3>\n                  {/* âœ… 4. Add Edit/Delete button group */}\n                  <div className=\"flex gap-3\">\n                    <button\n                      onClick={() =>\n                        handleEdit(note.id, note.title, note.content)\n                      }\n                      className=\"text-sm text-blue-600 hover:text-blue-800\"\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => handleDelete(note.id)}\n                      className=\"text-sm text-red-600 hover:text-red-800\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n                {/* Note content */}\n                <div className=\"prose prose-sm text-gray-700 whitespace-pre-wrap\">\n                  {note.content}\n                </div>\n                <div className=\"mt-4 text-xs text-gray-500\">\n                  Updated: {new Date(note.updatedAt).toLocaleString()}\n                </div>\n              </div>\n            ))}\n        </div>\n\n        {notes.length === 0 && (\n          <p className=\"text-gray-500 text-center mt-8\">\n            No notes yet. Create one above!\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKe,SAAS;;IACtB,qCAAqC;IACrC,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,IAAA,2IAAQ;IAC3D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,YAAY;QAChB,IAAI,MAAM,IAAI,IAAI;YAChB,QAAQ,MAAM,IAAI,IAAI;YACtB,yDAAyD;YACzD,SAAS;YACT,WAAW;QACb;IACF;IAEA,wCAAwC;IACxC,MAAM,aAAa,CACjB,IACA,cACA;QAEA,MAAM,WAAW,OAAO,oBAAoB;QAC5C,IAAI,aAAa,MAAM,QAAQ,iBAAiB;QAEhD,MAAM,aAAa,OAAO,sBAAsB;QAChD,IAAI,eAAe,MAAM,QAAQ,iBAAiB;QAElD,WAAW,IAAI;YAAE,OAAO,SAAS,IAAI;YAAI,SAAS;QAAW;IAC/D;IAEA,MAAM,eAAe,CAAC;QACpB,IAAI,QAAQ,+CAA+C;YACzD,WAAW;QACb;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAwC;;;;;;8BAGtD,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAyC;;;;;;sCACvD,6LAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,aAAY;4BACZ,WAAU;;;;;;sCAEZ,6LAAC;4BACC,OAAO;4BACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;4BAC1C,aAAY;4BACZ,MAAM;4BACN,WAAU;;;;;;sCAEZ,6LAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;8BAMH,6LAAC;oBAAI,WAAU;8BACZ,KACC,gCAAgC;qBAC/B,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,SAAS,GAAG,EAAE,SAAS,EACxC,GAAG,CAAC,CAAC,qBACJ,6LAAC;4BAEC,WAAU;;8CAGV,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAG,WAAU;sDACX,KAAK,KAAK;;;;;;sDAGb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDACC,SAAS,IACP,WAAW,KAAK,EAAE,EAAE,KAAK,KAAK,EAAE,KAAK,OAAO;oDAE9C,WAAU;8DACX;;;;;;8DAGD,6LAAC;oDACC,SAAS,IAAM,aAAa,KAAK,EAAE;oDACnC,WAAU;8DACX;;;;;;;;;;;;;;;;;;8CAML,6LAAC;oCAAI,WAAU;8CACZ,KAAK,OAAO;;;;;;8CAEf,6LAAC;oCAAI,WAAU;;wCAA6B;wCAChC,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc;;;;;;;;2BA/B9C,KAAK,EAAE;;;;;;;;;;gBAqCnB,MAAM,MAAM,KAAK,mBAChB,6LAAC;oBAAE,WAAU;8BAAiC;;;;;;;;;;;;;;;;;AAOxD;GAtHwB;;QAE6B,2IAAQ;;;KAFrC","debugId":null}}]
}